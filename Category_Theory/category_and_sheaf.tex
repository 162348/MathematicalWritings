\documentclass[uplatex, 12pt, dvipdfmx]{jsreport}
\title{圏と層}
\author{司馬博文 J4-190549\\hirofumi-shiba48@g.ecc.u-tokyo.ac.jp}
\date{\today}
\pagestyle{headings}
\usepackage[top=15truemm,bottom=15truemm,left=10truemm,right=10truemm]{geometry}
\usepackage{amsmath, amsfonts, amsthm, mathptmx, amssymb, ascmac, amscd, color, comment, tikz-cd, wrapfig}
\newtheorem{theorem}{定理} \newtheorem{definition}{定義} \newtheorem{axiom}[definition]{公理} \newtheorem{proposition}[theorem]{命題} \newtheorem{corollary}[theorem]{系} \newtheorem{lemma}[theorem]{補題} \newtheorem{problem}{問} \newtheorem{solution}{解} \newtheorem{remark}{注} 
\renewcommand{\proofname}{\bf ［証明］}
% \coprodをmathptmx（文書のフォントをTimesにするpackage）でも使えるようにするために．
\DeclareSymbolFont{cmletters}{OML}{cmm}{m}{it}
\DeclareSymbolFont{cmsymbols}{OMS}{cmsy}{m}{n}
\DeclareSymbolFont{cmlargesymbols}{OMX}{cmex}{m}{n}
\DeclareMathSymbol{\myjmath}{\mathord}{cmletters}{"7C}
\DeclareMathSymbol{\myamalg}{\mathbin}{cmsymbols}{"71}
\DeclareMathSymbol{\mycoprod}{\mathop}{cmlargesymbols}{"60}
\let\jmath\myjmath
\let\amalg\myamalg
\let\coprod\mycoprod
\setcounter{tocdepth}{2}

\begin{document}
\maketitle
\tableofcontents
\clearpage

\part{圏}

\begin{quotation}
    位相空間のホモロジー理論を創始したポアンカレの言葉に「数学とは異なるものを同じとみなす技術である」というものがある．この言葉は色々な解釈ができると思うが，自然科学のいろんな場面で似た形で現れる数学的現象の本質を抽出して抽象化し，一つの理論にまとめることはまさに「異なるものを同じとみなす技術」ではないだろうか．例えば，平面幾何学における相似拡大，解析学における関数のある点の近くでの一次近似，自然科学，経済学の様々な場面で現れる諸量の比例関係などの中に潜む線型性という本質を捉え，抽象化して理論としてまとめたものが線形代数学である．このように抽象化して理論をまとめておくことで数学的現象の本質の理解が深まり，また，新たな現象が見つかった時には，その理論が適用可能であることさえ確かめれば，同じ考察を再び繰り返すことなく抽象化された理論の恩恵を受けることができる．線形代数学が自然科学のあらゆる分野において重要なものであることはいうまでもないであろう．\footnote{志甫淳『層とホモロジー代数』（共立出版,2016）前文}
\end{quotation}

\chapter{集合論の準備：集合の公理とGrothendieck宇宙，写像とfiber積}
圏論の理論を展開するに当たって，集合のことばを基礎として展開するのが明瞭であろう．しかし，クラスの扱いは高度になるため，気楽にことばとしてのみ集合の概念を使うために，我々の考察の対象とする集合の舞台を，十分大きな集合$\mathfrak{U}$に限っておく．これを宇宙と呼ぶ．この時，この宇宙$\mathfrak{U}$に属する集合の全体$P(\mathfrak{U})$も，また集合である．
以上の議論を定義にまとめると，以下のようになる．

\begin{shadebox}\begin{definition}[Grothendieck宇宙]\rm{}\label{grothendieck}
    空でない集合$\mathfrak{U}$が宇宙であるとは，以下の４条件を充たすことをいう．\\
    1. ［推移的集合である］$\forall x,y \; [x\in y \wedge \; y\in \mathfrak{U} \rightarrow x\in \mathfrak{U}]$\\
    2. ［pairingに対する閉性］$\forall x,y \; [x,y\in \mathfrak{U} \rightarrow \{ x,y\} \in \mathfrak{U}]$\\
    3. ［powerに対する閉性］$\forall x \; [x\in\mathfrak{U} \rightarrow P(x) \in \mathfrak{U}]$\\
    4. ［unionに対する閉性］$\forall I,x_i \in \mathfrak{U}(i\in I) \; [\; \bigcup_{i\in I} x_i := {y:\; \exists i\in I \; y\in x_i}]$
\end{definition}\end{shadebox}

この時，宇宙$\mathfrak{U}$について，以下の命題が成り立つ．
\begin{shadebox}\begin{proposition}\rm{}空でない宇宙$\mathfrak{U}$について，以下の条件が成り立つ．\\
    5. $\varnothing\in\mathfrak{U}$\\
    6. $\forall x\in\mathfrak{U} \; [x\in\mathfrak{U}\rightarrow \{ x \} \in \mathfrak{U}]$\\
    7. $\forall x\in\mathfrak{U} \; [x\in\mathfrak{U}\rightarrow \bigcup_{y\in x}y\in\mathfrak{U}]$\\
    8. $\forall x,y\in\mathfrak{U} \; [x,y \in\mathfrak{U}\rightarrow x\times y\in\mathfrak{U}]$\\
    9. $\forall x,y\in\mathfrak{U} [x\in\mathfrak{U} \wedge y\subset x \rightarrow y\in\mathfrak{U}]$\\
    10. $\forall I,x_i\in\mathfrak{U}(i\in I) [I,x_i\in\mathfrak{U}(i\in I)\rightarrow \prod_{i\in I}x_i , \coprod_{i\in I}x_i\in\mathfrak{U}]$
\end{proposition}\end{shadebox}

\begin{shadebox}\begin{definition}[（小さな）集合]\rm{}集合とは，ZFC公理系を充たすものとする．特に，ZFC公理系に以下の公理\ref{axiom-grothendieck}を付け加えた公理系を充たすものを，\textbf{小さな集合}とする．
\begin{axiom}[Grothendieck宇宙の存在]\label{axiom-grothendieck}$\mathbb{N}\in\mathfrak{U}$を充たす宇宙$\mathfrak{U}$は存在する．\end{axiom}
\end{definition}\end{shadebox}
公理\ref{axiom-grothendieck}を付け加える理由は，この条件が（正確には，$\varnothing,V_\omega$を除いた非自明な宇宙$\mathfrak{U}$の存在が）ZFCから独立であるからである．この時，宇宙$\mathfrak{U}$自身は，集合ではあるが，小さな集合とはならないことに注意．そして，今後の議論で「集合」と言った時，暗黙に「小さな集合」を指すこととすれば，「（小さな）集合全体の集合$\mathfrak{U}$」という形で，真のクラスの取り扱いを回避することが出来る．
\begin{proposition}\rm{}
    構造$(\mathfrak{U};\in)$は，ZFC公理系のモデルである．
\end{proposition}
示せないけど，成り立つらしい．

こうして定めた宇宙$\mathfrak{U}$を１つ取り，以後固定する．

\begin{shadebox}\begin{definition}[写像とその相等]集合$X,Y$について，$X$の各元$x$に対して$Y$の元$f(x)$（$fx$や$f_x$とも書く）が唯一つ定まっている時，この対応$f$を$X$から$Y$への写像と呼び，$f:X\rightarrow Y$，または$X\xrightarrow{f}Y$で表す．\end{definition}
この時，$X$を始域(source)，$Y$を終域(target)と呼ぶ．なお，２つの写像$f,g:X\rightarrow Y$が等しいとは，$f=g\Longleftrightarrow \forall x \in X \; [f(x)=g(x)]$と定める．
\begin{definition}[写像の合成]２つの写像$f:X\rightarrow Y, g:Y\rightarrow Z$に対し，新たな写像を$h:X\rightarrow Z$を$\forall x \in X \; [h(x)=g(f(x))]$を充たす写像として構成できる．この$h$を合成写像と呼び，$g\circ f$と書く．\end{definition}
\begin{definition}[集合の積]２つの集合$X,Y$に対して，新たに（直）積と呼ばれる集合を$X\times Y:=\{ (x,y) :\; x\in X \wedge y\in Y\}$と構成出来る．但し，$(x,y)$は組と呼び，$(x,y)=(x',y')\Longleftrightarrow x=x'\wedge y=y'$を充たすと定義する． \end{definition}\end{shadebox}

集合論的立場からは，$(x,y):=\{\{x\},\{x,y\}\}$と定式化する．

\begin{shadebox}\begin{definition}[写像の可換図式]$X,Y,W,Z$を集合とし，$f,g,h,k$を写像とする．この時，以下の図式が可換であるとは，$h\circ f=k\circ g$が成立すること，即ち$\forall x\in X \; [h\circ f(x)=k\circ g(x) \in W]\cdots\star^1$が成立することと定義する．
    \begin{center}\begin{tikzcd}
        X \arrow[r, "f"] \arrow[d, "g"'] &  Y \arrow[d, "h"] \\
            Z \arrow[r, "k"'] &    W \\
    \end{tikzcd}\end{center}
\end{definition}\end{shadebox}
つまり，図式を有向グラフ（集合$X,Y,W,Z$を頂点，写像$f,g,h,k$を辺とした有向グラフ）だと思った時に，全ての有向道(directed path)が，写像の合成について，等しい写像を与えるような図式を，可換図式であるという．
この概念の集合論的に書いたからといって，必ずしもわかりやすいとは言い難い．こっちの方が視覚的だし．

\begin{shadebox}\begin{definition}[引き戻し(pullback)／fiber積]終域が等しい２つの写像$f:X\rightarrow S, g:Y\rightarrow S$について，その\rm{fiber積}$X_f\underset{S}{\times}{}_gY\subset X\times Y$を，$$X_f\underset{S}{\times}{}_gY:=\{ (x,y)\in X\times Y:\; f(x)=f(y)\in S \}$$と定義する．  \end{definition}\end{shadebox}
fiberとは（集合論で）単に逆像のことを意味する．２つの写像の，共通する終域$S$の各元$s$についての逆像$f^{-1}(s),g^{-1}(s)$同士の積$f^{-1}(s)\times g^{-1}(s)$を，全ての元$s\in S$について足し合わせたもの（合併）が，fiber積である．$$X_f\underset{S}{\times}{}_gY=\bigcup_{s\in S}f^{-1}(s)\times g^{-1}(s)$$
fiber積は射の合成の選択写像$c$の定義域を正確に捉える．

\begin{quote}
    A pullback is therefore the categorical semantics of an equation.\footnote{https://ncatlab.org/nlab/show/pullback}
\end{quote}

\clearpage

\chapter{圏}

\section{圏の定義}
\begin{shadebox}\begin{definition}[圏]\label{def-category}\rm{}圏とは，集合$C,M$と写像$s,t,c,e$の6-組$(C,M,s,t,c,e)$であって，次の図\ref{def-cd:1} \ref{def-cd:2} \ref{def-cd:3} \ref{def-cd:4}の可換図式を充たすもののことである．
    但し，写像$s,t,c,e$は夫々，$s:M\rightarrow C,t:M\rightarrow C,e:C\rightarrow M, c:M_s\underset{C}{\times}{}_tM \rightarrow M$である．
\end{definition}\end{shadebox}

\begin{figure}[ht] \begin{center}  \caption{\label{def-cd:1}　写像$c$の値（合成と呼ぶ）について，各$(g,f)\in M_s\underset{C}{\times}{}_tM$について，$s(f)=s(c(g,f))\wedge t(g)=t(c(g,f))$を要請する可換図式．}
    \begin{tikzcd} 
        M \arrow[d, "s"] \arrow[dr, phantom, "\circlearrowright"] & M_s\underset{C}{\times}{}_tM \arrow[l, "p_2" '] \arrow[r, "p_1"] \arrow[d, "c"] & M \arrow[dl, phantom, "\circlearrowright"] \arrow[d, "t"] \\
        C & M \arrow[l, "s"] \arrow[r, "t"'] & C
    \end{tikzcd}
\end{center}\end{figure}
但し，写像$p_1, p_2$は夫々第一，第二射影である．

\begin{figure}[ht] \begin{center}  \caption{\label{def-cd:2}　写像$c$について，結合則の成立$c(c(h,g),f)=c(h,c(g,f))$を要請する可換図式．}
    \begin{tikzcd}
            M_s \underset{C}{\times}{}_tM_s \underset{C}{\times}{}_tM \arrow[r, "1\times c"]\arrow[d, "c\times 1"] \arrow[dr, phantom, "\circlearrowright" near start] & M_s \underset{C}{\times}{}_tM \arrow[d, "c"] \\
            M_s \underset{C}{\times}{}_tM \arrow[r,"c"] & M
    \end{tikzcd}
\end{center}\end{figure}
但し，$1\times c$は積写像を表す．なお，図\ref{def-cd:1}より，$s(g)=s(c(h,g))=t(f)$が保証されているから，$(h,g,f)$は確かに必ず$M_s \underset{C}{\times_t}M_s \underset{C}{\times_t}M$に含まれるのである．

\begin{figure}[ht] \begin{center}  \caption{\label{def-cd:3}　写像$e$の値（単位射と呼ぶ）について，それが自己射であること，即ち$s\circ e=1_c=t\circ e$を要請する可換図式．}
    \begin{tikzcd}
        & C \ar[dl, "1_C"'] \ar[dr, "1_C"] \ar[dd, "e"] & \\
    C \ar[rr, phantom, "\circlearrowright" near start, "\circlearrowright" near end]  &  &  C \\
        &  M \ar[ul, "s"] \ar[ur, "t"'] &  \\
\end{tikzcd}
\end{center}\end{figure}
つまり，$C$の任意の元を$A$とすると，その値$e(A)$は射$e(A):A\rightarrow A$となる必要がある．このような射のうち特別なものを$e$の値として１つ定めて単位射と呼び，図\ref{def-cd:3}により全ての$C$の元について定まる．この特別な自己射を他から区別する性質（合成に関して\textrm{identity}である）を次で定める．

\begin{figure}[ht] \begin{center}  \caption{\label{def-cd:4}　写像$e$の値（単位射）の特徴付け．$c(e(t(f)),f)=c(f,e(s(f)))$，即ち$M$の各元$f:A\rightarrow B$に対して，$f\circ e(A)=e(B)\circ f\underline{=f}$の成立を要請する可換図式．}
    \begin{tikzcd}
        & M \ar[dl, "{(e\circ t,1_M)}"'] \ar[dr, "{(1_M,e\circ s)}"] \ar[dd, "1_M"] & \\
    M_s\underset{C}{\times}{}_tM \ar[dr, "c"'] \ar[rr, phantom, "\circlearrowright" near start, "\circlearrowright" near end]  &  &  M_s\underset{C}{\times}{}_tM \ar[dl, "c"] \\
        &  M  &  \\
    \end{tikzcd}
\end{center}\end{figure}
道が３通りあるので，下線部の通り，２本の等式になることに注意．この性質は一種のinterfaceの役割を果たす．
但し，写像$(1,e\circ s)$は，対角写像$\delta$と積写像$1\times e\circ s$との合成写像で，
$$\begin{array}{ccc}
    (1,e\circ s):M & \rightarrow & M_s \underset{C}{\times}{}_tM\\
    \rotatebox{90}{$\in$} & & \rotatebox{90}{$\in$}\\
    f & \longmapsto & (f,e(s(f)))
\end{array}$$
である．

\section{定義の脱構築，記号についての注意}

圏の要素は，以下のように６つの要素に分解できる．\\
(1-1) \; ［２つの集合$C,M$を議論領域とする］圏を$\mathcal{C}$とした時，$C=\rm{ob}\mathcal{C}, M=\rm{arr}\mathcal{C}$とも書く．\\
(1-2) \; ［$C,M$間の一定の関係］$M$の各元が，順番を区別して，$C$の元２つと対応づけられている必要がある．この構造を$f:A\rightarrow B$などと表す．定式化の仕方は少なくとも３つある．「全ての射に「始対象」「終対象」と呼び分けられる２つの対象を紐付ける選択写像$s,t:M\rightarrow C$を定める」という上記の方法や，「そもそも，集合$M$を各$A,B\in C$に対して$\rm{Mor}(A,B)$の和集合として構成する」方法，あるいは「集合$C$が各$f\in M$に対して２つずつ定まっていくとする」方法などがある．\\
(2-1) \; ［射の合成が$C,M$間の関係を保存することと閉性］閉性は，fiber積$M_s\underset{C}{\times}{}_tM$を定義域とし，$M$を値域とする合成射の選択写像$c$を１つ定めることに等しい．残る，合成射が保存すべき$C,M$間の構造は，全て２つの写像$s,t$で捕まえられているので，可換図式\ref{def-cd:1}のように表現出来る．\\
(2-2) \; ［射の合成の結合性］可換図式\ref{def-cd:2}で表現される．\\
(3-1) \; ［単位射の存在性と定義（自己射である）］存在性は，$C$の各元に対して，特別な射を１つ選び出す選択写像$e:C\rightarrow M$を１つ定めることに等しい．そして，その射が自己射である条件は，可換図式\ref{def-cd:3}のように表現される．\\
(3-2) \; ［単位射の特徴付け］単位射は，他の自己射から区別される，特別な性質を充たす．それは，「単位射との結合は，右からであろうと左からであろうと，射に変化を与えない」という単位性(identity)である．なお，この性質を充たすような射は一意に定まることに注意．だからこれを「単位射の特徴付け」とも呼べる．\par

今回の定義は，圏を６つ組とし，残る条件(2-1)の一部，(2-2)，(3-1)の一部，(3-2)を可換図式を用いて定式化した．定義の流儀は他にもあるだろうが，その本質は上に述べた６つに整理できるのではないかと考えている．\\
射の合成$c(g,f)$は以降，写像の合成と同じ記号を用いて，$g\circ f$と書く．$A\in C$に対してその単位射は，恒等写像の記号を用いて，$e(A)$を$1_A$と書く．
６つ組として定義した圏のことも，$C$で表してしまうことが多い．
なお，$\mathrm{Hom}_C(A,B)=\mathrm{Mor}_C(A,B)=\{ f\in M\mid s(f)=A, t(f)=B \}$と定める．

\section{圏の例５つ}

前文に書いたように，おしなべて，数学の理論は，様々な場面に共通して現れる何らかの「型」を対象とする．その「型」に当てはまる様々な具体的対象を同時に議論できる．
前半の例は全て，対象は何らかの集合であった．（なお，「集合論の準備」の節で言及したように，本来の意味では「有限次元実線型空間全体の集合」などの対象は定義出来ないことに注意．）この場合に，共通した「型」についての理論をもたらすのも圏論の強みであるが，それだけに止まらず，後半の２つのような圏の例もある．
それらに共通するのは，特別な集合として捉えられていた構造自体が，「圏の特別な場合」とも見なせるようなものを考えていく．具体的には，monoidとposetという２つの構造に対して，圏論的な観点から特徴付けを与える．これらはそれぞれ，射を，代数的演算の雛形だと見る例と，順序関係の雛形だと見る例とになっている．
圏は思ったより深い「型」で，非常に広い範囲に適用できる．

\subsection{集合の圏\bf{Sets}}

$C$を小さな集合全体の集合とする．
$A,B,D\in C$に対して，$\mathrm{Mor}_c(A,B)=\mathrm{Map}(A,B)$とし，$$\begin{array}{lcr}\circ : \mathrm{Map}(B,D)\times\mathrm{Map}(A,B)&\rightarrow&\mathrm{Map}(A,D)\\ \hspace{16mm}\rotatebox{90}{$\in$} & & \rotatebox{90}{$\in$}\\ \hspace{13mm}(g,f) & \longmapsto & g\circ f \end{array}$$
と言うように射の合成を，写像の合成として自然に定義し，恒等射は恒等写像$1_A:A\rightarrow A$とすると，これは圏をなす．

\subsection{線型代数学からの例}

$C$を有限次元実線型空間全体の集合とする．
$V,W\in C$について，$\mathrm{Mor}_c(V,W)=\mathrm{Hom}_\mathbb{R}(V,W)$とし，射の合成と恒等写像$1_V$については前述の集合の圏と同様にすれば，これは圏をなす．

\subsection{微積分学からの例}

$C$を$\mathbb{R}^2$上の開集合$U$全体の集合とする．
$U,V\in C$に対して，射の集合を$\mathrm{Mor}_c(U,V)=\{f:U\rightarrow V: f\text{は連続微分可能な写像}\}$と定める．\\
すると，集合としての写像の合成と，恒等射を写像$1_U:(x,y)\longmapsto (x,y)$とすれば，これは圏をなす．

\subsection{同型射}

\begin{shadebox}\begin{definition}[可逆，同型，逆射]
    射$f:A\rightarrow B$に対して，射$g:B\rightarrow A$であって，$g\circ f=1_A \; \wedge \; f\circ g=1_B$となるとき，$g$を\textbf{射$f$の逆射}といい，$f$は可逆である，或いは同型である，と言う．なお，逆射は存在すれば一意的である．
\end{definition}\end{shadebox}

\subsection{monoidの圏論的特徴付け：単一対象圏：射の合成を，演算の雛形と見る}

対象の集合$C$を一点集合$\{ A\}$とする．
すると，$s,t$は定値写像として一意に定まる．
これにより，$c$の定義域は$M_s\underset{C}{\times}_tM=\{ (g,f)\in M\times M : s(g)=t(f)=A \}=M\times M$となるから，結局$c:M\times M\rightarrow M$である．これは任意の$M$の２元の間に定義された演算となるから，$c(f,g)$を$f\cdot g$と書くことにする．写像$e:C\rightarrow M$の値を$e:=e(A)=1_A$と書くこととする．
すると，この単一対象圏$C$は，後は$(h\cdot g)\cdot f = h\cdot (g\cdot f)$と$f\cdot e=e\cdot f = f$という２つの公理を充たす3-組$<M,\cdot :M\times M\rightarrow M,e>$に等しくなり，これはmonoidの公理に他ならない．

\begin{screen}
    モノイドとは，対象の集合$C$が一点集合である圏（単一対象圏）のことである．この時，圏$(\{ A\}, M, s, t, c, e)$の全体が，モノイド$M=(M,\cdot,e)$全体に一致する．MorphismとMonoidとで頭文字が一致しているのが運命的．また一般の圏$C$についても，各対象$a\in C$について，$\mathrm{Hom}_C(a,a)$はmonoidになる．
    なお，モノイド$M$の全ての元が可逆であった時，$<M,\cdot,e,{}^{-1}>$を特に群と言う．
\end{screen}

\subsection{順序関係の圏論的特徴付け：射の合成を，順序関係の雛形と見る}

前順序(preorder)とは，任意の２つの対象の間に，射が高々１つしか存在しないような圏のことである．このような圏のことを，\textbf{細い圏(posetal category, thin category)}という．そのような例を実際に構成してみる．$C$を対象の集合とする．$\Delta_C :=\{ (x,x)\in C\times C \mid x\in C \}$を対角集合として，$\Delta_C \subset M\subset C\times C$を充たす$M$を自由に定める．$s,t$を第一射影と第二射影とする．
この下で，元$(A,A)$を対象$A\in C$の単位射とすれば，$<C,M,s,t,c,e>$は圏をなす．

この上さらに，全ての同型射は単位射しかないとき，即ち，任意の対象にとって同型な対象は自分自身しか居ない場合（このとき，その圏は\textbf{skeletalである}という），「$M$は$C$の順序を定める」という．これは，圏を有向グラフとして捉えなおしたようなものである．「射が存在する」という関係を，順序関係だと捉えれば，それはHesse図の例に他ならない．

以降，$C$の２元$x,y\in C$に対して，$(x,y)\in M$という関係がある時，$x\le y$と書くこととする．単位射の存在性より，任意の$x\in C$に対して$x\le x$であり（反射律），射の合成が定義されていることにより，推移律$x\le y \wedge y\le z \rightarrow x\le z$は満たされる．この時点で「前順序(pre-order)」と呼ぶ．
続いて「全ての同型射は単位射である」という条件により，反対称律$x\le y \wedge x\ge y \rightarrow x=x$が満たされる．よって，$M$によって上記のように順序を定めた集合$C$は，確かに順序集合となっている．

\begin{screen}
    前順序集合(poset)とは，任意のHom集合が元をたかだか１つしか持たない，「細い圏」のことである．（半）順序集合とは，skeletalな細い圏のことである．例えば，対象の集合$C$に対して，$\{ (x,x) \in C\times C \mid x\in C \}\subset M\subset C\times C$を充たす射の集合$M$をもち，全ての同型射は単位射である時，$M$が$C$上に定める「射が存在する」という関係は「順序関係」と等しい．\\
    これはHasse図と順序関係の公理との対応に似ている．
\end{screen}

\clearpage
\chapter{関手(functor)と圏の圏\textbf{CAT}の様子}

圏論の視点として，圏という対象を定めたのなら，その間の射を定めたくなる．

\section{（共変）関手(covariant functor)の定義}

\begin{shadebox}\begin{definition}[（共変）関手]
    ２つの圏$C=(C,M,s,t,c,e),C'=(C',M',s',t',c',e')$に対して，圏$C$から圏$C'$への（共変）関手とは，写像$F_C:C\rightarrow C'$と写像$F_M:M\rightarrow M'$の組$(F_C,F_M)=:F$であって，以下の可換図式\ref{cd-5}，\ref{cd-6}，\ref{cd-7}を充たすもののことである．
\end{definition}\end{shadebox}
$F_C$をobject function，$F_M$をarrow functionなどという．

\begin{figure}[ht]\begin{center} \caption{\label{cd-5}　射に付随する始対象と終対象との関係を，$F_C$と$F_M$が整合的に保存すること．$M$の射$f:A\to B$について，対応する$M'$の射が$F_M(f):F_C(A)\to F_C(B)$であることを要請する可換図式．}
    \begin{tikzcd}
        C \ar[d, "F_C"'] \ar[dr, phantom, "\circlearrowright"] & M \ar[l, "s"'] \ar[r, "t"] \ar[d, "F_M"] \ar[dr, phantom, "\circlearrowright"] & C \ar[d,"F_C"] \\
        C & M' \ar[l,"t'" red] \ar[r, "s'"' red] & C
    \end{tikzcd}
\end{center}\end{figure}

\begin{figure}[ht]\begin{center} \caption{\label{cd-6}　射の合成を保存する．先に合成しても，後で合成しても同じことである．つまり，$F(g\circ f)=F(g)\circ F(f)$を要請する可換図式．}
    \begin{tikzcd}
        M_s\underset{C}{\times}{}_tM \ar[r,"c"] \ar[d,"F_M\times F_M"'] & M \ar[dl, phantom, "\circlearrowright"] \ar[d,"F_M"] \\
        M'_{s'}\underset{C'}{\times}{}_{t'}M' \ar[r,"c'"'] & M'
    \end{tikzcd}
\end{center}\end{figure}
なお，図\ref{cd-5}より，$(f,g)\in M_s\underset{C}{\times}{}_tM$ならば，その$F_M\times F_M$による像は必ず$(F_M(f),F_M(g))\in M'_{s'}\underset{C'}{\times}{}_{t'}M'$である．

\begin{figure}[ht]\begin{center} \caption{\label{cd-7}　単位射は単位射に対応する．$C$の元$A$に対し，$F_M(1_A)=1_{F_C(A)}$を要請する可換図式．}
    \begin{tikzcd}
        C \ar[r,"e"] \ar[d,"F_C"'] \ar[dr,phantom,"\circlearrowright"] & M \ar[d,"F_M"] \\
        C' \ar[r,"e'"'] & M'
    \end{tikzcd}
\end{center}\end{figure}

以上，３つの構造を保つ写像（の組）が関手であるから，まさに圏準同型である．

\subsection*{関手の定義の吟味，記法の注意}
圏を６つ組と見做し，残りの４つの条件\\
\hspace{3mm} (2-1)'\; 射の合成が，始対象と終対象の２つの属性に対して構造を保つ．\\
\hspace{3mm} (2-2)\; 射の合成が結合的である．\\
\hspace{3mm} (3-1)'\; 単位射は自己射である．\\
\hspace{3mm} (3-2)\; 単位射の特徴付け\\
を４つの可換図式を用いて圏を定義したのであった（定義\ref{def-category}）．このうち，(2-2)と(3-2)は関手の定義に関与しない．(2-1)と(3-1)に加えて，(1-2)が，関手が保存すべき条件であり，それぞれが図\ref{cd-6}，\ref{cd-7}，\ref{cd-5}に対応する．

概念としては関手は「写像の組」であるが，以降関手自体のことや，$F_C,F_M$のいずれのことも，$F$と書く．

\section{圏の圏\textbf{CAT}の定義}

\subsection{恒等関手}
$F_C=1_C, F_M=1_M$と定めれば，３つの可換図式を自明な形で満たし，これは関手となる．これを恒等関手と呼び，$1_C:C\rightarrow C$と書く．これは写像の合成に関しての単位元となる．

\subsection{関手の合成}
２つの関手$C\xrightarrow{F}C'\xrightarrow{G} C''$に対して，新たな関手$G\circ F:C\rightarrow C''$を，写像の合成を用いて
$$(G\circ F)_C(A):=G_C(F_C(A))\hspace{3mm} (\mathrm{for\hspace{0.5em} all}\; A\in C)，\hspace{5mm}(G\circ F)_M(f):=G_M(F_M(f))\hspace{3mm} (\mathrm{for\hspace{0.5em} all}\; f\in M)$$
と構成する．すると，これは結合的である．

\subsection{圏の圏 \bf{CAT}}
対象を圏とし，射を関手とする．合成は「関手の合成」を用いると結合的で，単位射を「恒等関手」とすればこれは特徴づけを充たす．従ってこれは圏をなし，\textbf{CAT}，［圏］などと書く．なお，本来は「大きな圏全体を対象の集合とした圏」は定義出来ない．しかし今回は議論を宇宙$\mathfrak{U}$というミニチュア世界に限ったために，「圏の全体」と言ってもかろうじて１つの集合を得る．

\section{部分圏(subcategory)と充満部分圏}

\subsection{部分圏の定義}
\begin{shadebox}\begin{definition}[部分圏]
    $(C,M,s,t,c,e)$を圏とする．$C',M'$をそれぞれ$C,M$の部分集合とした時，これらに誘導される写像$s\upharpoonright M', t\upharpoonright M', c\upharpoonright M'_{s\upharpoonright M'}\underset{C'}{\times}{}_{t\upharpoonright M'}M', e\upharpoonright C'$について，$(C',M',s', t', c', e')$が圏をなす時，これを$C$の部分圏という．
\end{definition}\end{shadebox}
この時，２つの包含写像$i_C:C'\rightarrow C, i_M:M'\rightarrow M$によって定まる明らかな忠実関手$i:C'\rightarrow C$が存在する．これを\textbf{包含関手}と呼ぶ．
しかし，圏論においては，部分圏そのものではなく，対象に関する制限のみを課していて，対象の間の射は全く同じになるという特別な場合である充満部分圏の方が中心的な役割を演じる．

\subsection{充満部分圏(full subcategory)}
\begin{shadebox}\begin{definition}[充満部分圏]
    $(C,M,s,t,c,e)$を圏とする．$C'$を$C$の部分集合とした時，$M'$を$M':=\{ f\in M \mid s(f), t(f)\in C \}$と構成すれば，これは必ず部分圏をなす．これを特に「充満部分圏」と呼ぶ．
\end{definition}\end{shadebox}
即ち，$C$の部分圏$C'$のうち，任意の対象$A,B\in C$について，$\mathrm{Hom}_C(A,B)=\mathrm{Hom}_{C'}(A,B)$が成立するような部分圏を充満部分圏という．「頂点集合が生成する部分グラフ(induced subgraph)」の定義に似てるが，それとの相違点は，グラフの方では辺はたかだか１つしか存在し得ないが，（充満部分）圏ではHom集合の濃度は不問である．

\subsection{monoid，monoidの圏}
「圏のうち，対象を１つしか持たないもの」という圏の特別な場合がmonoidなのであった．
従って，任意の圏$C$について，その任意の一点集合である部分集合$\{ A\}\in C$から生成される充満部分圏はmonoidである．これを\textbf{自己射のなすモノイド}と呼び，$\mathrm{End}(A):=\mathrm{Mor}_C(A)$と書く．
一方で，モノイドの射は，単一対象圏の間の関手と同一視できる．（命題\ref{monoidの射}）何故ならば，モノイドの射も，単一対象圏間の関手も，充たすべき条件は等しく，ある結合的で単位元の存在する演算$\cdot$に対して，$f(x\cdot y)=f(x)\cdot g(x)$かつ$f(e_M)=e_{M'}$であることであるからである．
よって，モノイドの圏\textbf{Mon}は，圏の圏\textbf{Cat}の，「対象を１つしか持たない圏全体の集合」についての充満部分圏である．

全く類比的に，モノイド$M$であって，全ての射が可逆であるもの$M^\times :=\{ x\in M\mid xは可逆 \}$は群である．
$\mathrm{End}_C(A)$はモノイドであったから，$\mathrm{End}_C(A)^\times$は群であり，これを$\mathrm{Aut}_C(A)$と書き，\textbf{$A$の自己同型群}という．特に，$C=\mathbf{Set}$である時，$C\ni A=\{ 1,2,3,\cdots,n \}$についての自己同型群$\mathrm{Aut}_C(A)$は\textbf{$n$次対称群}といい，$\mathfrak{S}_n$と書く．
また，その間の関手が群の射であるから，これも圏の圏\textbf{Cat}の，また同時にmonoidの圏\textbf{Mon}の充満部分圏である．以上のことより，以下のような包含関手$i,i'$が存在する．
$$\mathbf{Grp}\xrightarrow{i}\mathbf{Mon}\xrightarrow{i'}\mathbf{Cat}$$

\begin{proposition}[monoidの射]\label{monoidの射}
    $M,M'$をmonoidとし，$f:M\to M'$をその準同型とする．この時，対応する圏$C,C'$で，射の集合を$\mathrm{Mor}_C(A,A)=M, \mathrm{Mor}_{C'}(A',A')=M'$（但し，$C=\{ A\},C'=\{ A'\}$とした）とする単一対象圏が存在し，その間の関手$F:C\to C'$であって，$f:M\to M'$と対応するものが必ず存在する．
    また，この逆も成り立つ．即ち，任意の一点圏$C,C'$の間の関手に，対応するmonoidの射$f$が構成できる．
\end{proposition}

\subsection{poset, posetの圏}
順序集合間の射である単調写像は，順序集合を圏と見なした時の関手と同一視できる．
従って，［順序集合］は［圏］の充満部分圏である．

\subsection{モノイドの射と群の射の例：指数表示と指数法則とは何か}
$(M,\cdot, e_M)$をモノイドとする．モノイド$(\mathbb{N},+,0)$からの射
$$\begin{array}{lcr}f:\mathbb{N}&\rightarrow &M\\ \rotatebox{90}{$\in$} & & \rotatebox{90}{$\in$} \\ n & \longmapsto & x^n \end{array}$$
を指数表示という．ただし，$x^0 = e_M, x^1 = x$であり，以降$x^{n+1}=x^n\cdot x$と帰納的に定めた．

$f$が本当にモノイドの射になっていることを確認する．モノイドを圏とみて，$f$が関手であるための条件（可換図式\ref{cd-5},\ref{cd-6},\ref{cd-7}）を充たすかどうか検証する．
いずれも単一対象圏なので，図\ref{cd-5}は自ら明らかである．
図\ref{cd-6}$f(n+m)\overset{M}{=}f(n)\cdot f(m)$は$x^{n+m}=x^n\cdot x^m$がから成り立つことが確認できることにより保証される．
最後に，やはり定義から，$f(0)=e_M$である．
指数表示と指数法則とは，和と積という２つの演算の間の，モノイド準同型だったのか．

全く同様に，２つの群$<Z,+,0>$と$<G,\cdot, e_G>$の間の射だと考えれば，指数$n$の走る範囲は整数にまで拡張できる．が，積を備えた方の代数系が群をなすことがその条件である．
\textcolor{blue}{では，複素行列を指数に取る場合はどうだろうか？}


\section{反変関手(contravatiant functor)と逆転圏}
Fが共変関手であるとき，それによる$f\in M$の値を$F(f)=f_*$と書き，$F$が反変関手であるとき$F(f)=f^*$と書く．

\subsection{反変関手の定義}

\begin{shadebox}\begin{definition}[（反変）関手]
    ２つの圏$C=(C,M,s,t,c,e),C'=(C',M',s',t',c',e')$に対して，圏$C$から圏$C'$への反変関手とは，写像$F_C:C\rightarrow C'$と写像$F_M:M\rightarrow M'$の組$(F_C,F_M)=:F$であって，以下の可換図式\ref{cd-8},\ref{cd-9}と，共変関手の場合と同一の図式\ref{cd-7}を充たすもののことである．
\end{definition}\end{shadebox}

\begin{figure}[ht]\begin{center} \caption{\label{cd-8}　射に付随する始対象と終対象の関係を，一律に逆転させること，即ち$M$の射$f:A\to B$に対応する$M'$の射が$F_M(f):F_C(B)\to F_C(A)$であることを要請する可換図式．}
    \begin{tikzcd}
        C \ar[d, "F_C"'] \ar[dr, phantom, "\circlearrowright"] & M \ar[l, "s"'] \ar[r, "t"] \ar[d, "F_M"] \ar[dr, phantom, "\circlearrowright"] & C \ar[d,"F_C"] \\
        C & M' \ar[l,"t'" red] \ar[r, "s'"' red] & C
    \end{tikzcd}
\end{center}\end{figure}

\begin{figure}\begin{center} \caption{\label{cd-9}　$F(g\circ f)=F(f)\circ F(g)$を要請する可換図式．ただし，$F_M\times F_M\circ\omega$とは，図\ref{cd-10}のような合成写像とする．}
    \begin{tikzcd}
        M_s\underset{C}{\times}{}_tM \ar[r,"c"] \ar[d,"F_M\times F_M \circ \omega"' red] & M \ar[dl, phantom, "\circlearrowright"] \ar[d,"F_M"] \\
        M'_{s'}\underset{C'}{\times}{}_{t'}M' \ar[r,"c'"'] & M'
    \end{tikzcd}
\end{center}\end{figure}

\begin{figure}[ht]\begin{center} \caption{\label{cd-10} 写像$F_M\times F_M\circ\omega$の定義}
    \begin{tikzcd}
        M_s\underset{C}{\times}{}_tM \ar[r, "\omega"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & M_t\underset{C}{\times}{}_sM \ar[d, phantom, "\rotatebox{90}{$\in$}"] \ar[r, "F_M\times F_M"] & M'_{t'}\underset{C}{\times}{}_{s'}M' \ar[d, phantom, "\rotatebox{90}{$\in$}"]\\
        (g,f) \ar[r, mapsto] & (f,g) \ar[r, mapsto] & (F_M(f), F_M(g))=(f_*,g_*)
    \end{tikzcd}
\end{center}\end{figure}

\begin{figure}[ht]\begin{center} \caption{単位射は単位射に対応する（共変関手の定義と同一）．}
    \begin{tikzcd}
        C \ar[r,"e"] \ar[d,"F_C"'] \ar[dr,phantom,"\circlearrowright"] & M \ar[d,"F_M"] \\
        C' \ar[r,"e'"'] & M'
    \end{tikzcd}
\end{center}\end{figure}

\subsection{逆転圏}

圏$C=(C,M,s,t,c,e)$に対して，$C^{op}:=(C,M,t,s,c\circ\omega,e)$（射の向きを入れ替え，合成の順序も逆にしたもの）は必ず圏をなす．これを$C$の\textbf{逆転圏}と呼ぶ．

逆転圏の概念を用いれば，反変関手$F:C\rightarrow C'$の議論は共変関手$G:C^{op}\rightarrow C'$の議論に帰着させられる．別の表現で言えば，１つの共変関手を定めることは，共役な反変関手を暗黙のうちに定めていることになる．
\begin{proposition}[反変関手に対応する共変関手]
    反変関手$F:C\rightarrow C'$に対して，以下の図式を可換にする共変関手$G:C^{op}\rightarrow C'$が唯一つ存在する．
    \begin{center} \begin{tikzcd}
        C \ar[r, "{}^{op}"] \ar[dr, "F"'] & C^{op} \ar[d, "G"] \\
        {} & C'
    \end{tikzcd} \end{center}
\end{proposition}

今後「余(co-)」という接頭辞の付いた概念は，その概念の，逆転圏における対応物である．
ある圏で成り立つ事柄は，その逆転圏でも成り立つから，そのようにして見なして良い概念を，「余(co-)」を付けて呼ぶ．

\subsection{monoidでの例：代数的演算における逆転とは，可換性のこと}
$M$をモノイドとすると，逆転単一対象圏$M^{op}$も勿論モノイドであり，これを\textbf{$M$の逆転モノイド}という．$M=M^{op}$の時，このモノイド$M$は可換であるという．

\subsection{posetでの例：関手としての冪集合構成}
圏$(C,\Delta_C\subset M\subset C\times C, p1,p2,c,e)$で，$M$の可逆な射は単位射のみである時，$M$は$C$上に順序を定めると言うのだった．

勝手な集合$X\in\mathbf{Set}$に対して，$C=P(X)$とし，この$C$を対象全体の集合とし$M$をその間の包含写像全体とする圏$C$を考えると，順序集合$C$を圏として構成したことに他ならない．この圏$C$は$\mathbf{Set}$の部分圏となっているが，充満部分圏ではない．微妙な存在容態である．しかし，今見たように，$C=P(X)$が\textbf{Poset}の対象であることに注目する．

ここで，この「集合の冪集合を取る」という操作を，集合の圏\textbf{Set}から順序集合の圏\textbf{Poset}への関手と見て，冪集合関手$P^*,P_*$なるものを定義することを考える．
まず，ある集合の冪集合を取ると言う，対象についての写像$P_C$は，$X\in\mathbf{Set}$を$C=P(X)\in\mathbf{Poset}$に写す写像$P_C:\mathbf{Set}\to\mathbf{Poset}$とする．
\begin{center}\begin{tikzcd}
    P_C:［集合］\ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & ［順序集合］\ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    X \ar[r, mapsto] & P(X)
\end{tikzcd}\end{center}
次に射写像$P_M$を考える．適当な写像$f:X\to Y$の$P_M$による値は，\textbf{Poset}の対象$P(X),P(Y)$間の射である必要がある．即ち包含関係$\subset$についての順序集合である$P(X),P(Y)$の間の単調写像となるように定義する必要があるが，これを充たす定義の仕方は共変的なものと反変的なものとの２通りある（本質的には１通り）．
写像$f:X\to Y$を共変的に移す射写像$P_{*M}$（${}_*$とも書く）を以下のように定義する．
\begin{center}\begin{tikzcd}
    P_{*M}:［集合］\ar[d, phantom, "\rotatebox{90}{$\in$}"] \ar[r] & ［順序集合］\ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    f:X\to Y \ar[r, mapsto] & f_*:P(X)\to P(Y)
\end{tikzcd}\end{center}
但し，写像$f_*:P(X)\to P(Y)$は，以下のように，$X$の部分集合$A$に対して，その$f$による像$f(A)$を対応させる\textbf{像写像(image function)}である．
\begin{center}\begin{tikzcd}
    f_*:P(X) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & P(Y) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    A \ar[r, mapsto] & f(A)
\end{tikzcd}\end{center}
まず，これが確かに［順序集合］の射となることを確認する．
\begin{proposition}[像写像$f_*$は単調写像である]
    写像$f_*:P(X)\to P(Y)$を，上で定めた像写像とする．$A\subset A'\subset X$ならば$f(A)\subset f(A') (\subset Y)$が成り立つ．
\end{proposition}
\begin{proof}
    いま，
    \begin{center}\begin{tikzcd}
        f_*:P(X) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & P(Y) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        A \ar[r, mapsto] \ar[d, phantom, "\rotatebox{90}{$\subset$}"] & f(A) \\
        A' \ar[r, mapsto] & f(A')
    \end{tikzcd}\end{center}
    $f(A')=\varnothing$である時（即ち$A'=\varnothing$である時），$f(A')\subset f(A)$である．以降，$f(A')\ne\varnothing$とする．$x\in f(A')$を任意に取る．すると，$f^{-1}(x)\subset A'$であるから，$A'\subset A$と併せて，$f^{-1}(x)\subset A$を得る．よって，$x\in f(A)$である．\footnote{$A$の部分集合の像は$A$の像に含まれることの表現の１つであるが，集合の逆像(preimage)と元の逆像(fiber)との間の記号$f^{-1}$混用や，$\in$や$\subset$の記号が入り混じっていて一見論理的な正確さがわかりにくい．全ての$y\in X$について，$y\in f^{-1}(x)\Longrightarrow y\in A\Longrightarrow f(y)=x\in f(A)$より，$f^{-1}(x)\subset A\Longleftrightarrow x\in f(A)$}以上より，$f(A')\subset f(A)$．
\end{proof}
これは，$f_*:P(X)\to P(Y)$が，包含写像を射として圏と見なした順序集合$P(X)$と$P(Y)$の間の関手となっていることも含意するが，証明は省略する．適切な同一視が存在するのである．
次に，関手$P_*:=(P_C,P_{*M})$が確かに関手の公理を充たすことを確認する．
\begin{proposition}[共変冪集合関手$P_*$]
    上記のように定義した写像の組$P_*:=(P_C,P_{*M})$は，関手$\mathbf{Set}\to\mathbf{Poset}$である．
\end{proposition}
\begin{proof}
    最初の図式については，$f:X\to Y$について$P_{*M}:P_C(X)\to P_C(Y)$と定義しているから充たす．
    残る２つの図式については，
    $$\left\{ \begin{array}{c}
        (f\circ g)_* = f_*\circ g_* \\
        1_{X*} = 1_{P(X)}
    \end{array} \right.$$が成り立つことを確認すれば良い．
    任意の写像$f:X\to Y, g:Y\to Z$について，
    \begin{center}\begin{tikzcd}
        (f\circ g)_*:P(X) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \ar[r] & P(Z) \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \\
        A \ar[r, mapsto] & f\circ g(A) \ar[r, equal] & f(g(A)) \\
        f_*\circ g_* : P(X) \ar[r, "g_*"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & P(Y) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \ar[r, "f_*"] & P(Z) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        A \ar[r, mapsto] & g(A) \ar[r, mapsto] & f(g(A))
    \end{tikzcd}\end{center}
    より，$(f\circ g)_* = f_*\circ g_*$である．
    次に$1_X:X\to X$の$P_{M*}$による像は，$P(X)$の元$A$を，$1_X$による像，即ち$A$に写す写像$1_{X*}:P(X)\to P(X)$であるが，これは$P(X)$上の恒等写像$1_{P(X)}$に等しい．よって，$1_{X*} = 1_{P(X)}$も分かる．
\end{proof}

よって，関手$P_*$を定めることが出来た．同様にして，$P^*$も定められ，以下の図式は可換になる．
\begin{center}\begin{tikzcd}
    \mathbf{Set} \ar[r, "{}^{op}"] \ar[dr, "P_*"'] & \mathbf{Set}^{op} \ar[d, "P^*"] \\
    & \mathbf{Poset}
\end{tikzcd}\end{center}
\begin{eqnarray*}
    f_* : P(X)\rightarrow P(Y) \hspace{3mm}像写像\mathrm{(image \hspace{0.5em}function)}\\
    f^*:P(Y)\rightarrow P(X) \hspace{3mm}逆像写像\mathrm{(preimage\hspace{0.5em} function)}
\end{eqnarray*}

\begin{screen}関手化とは，関手$F_C$の終域となる対象の１つ１つが圏と見なせる場合の，$F_M$の像を捉えるための言葉である．考察が１段階高次元になった様子を捉える．後述の表現可能関手はその例で，「関手化」として捉えられる．Hom類間の写像は，関手の射をなすと捉えられる．
\end{screen}

反変版の方の冪集合関手は，なんだか連続写像との関連性を感じる．「反変版の冪集合関手は2点集合によって表現されている．」を検証する．\footnote{https://ja.wikipedia.org/wiki/関手}

\section{Hom functor，忘却関手}\label{section-hom-functor}

Hom関手は，$C$上の対象の組$(c,c')\in C^{op}\times C$を引数にとり，その間の射の集まりを，然るべき圏の対象へ（今回は$\mathrm{Hom}_C(c,c')\in\mathbf{Set}$に）写す関手のことである．そして，$C$の対象の組$(c,c')$と$(d,d')$の間の射は，それらの組の間のホム集合の間の射$h:\mathrm{Hom}_C(c,c')\to\mathrm{Hom}_C(d,d')$に写す．
このように，積圏(product category)上に定義される関手を双関手(binary functor / bifunctor)と呼ぶ．$n$変数への拡張を重関手(multifunctor)と呼ぶ．
なお，Hom関手はプロ関手(profunctor)の例になっていて，特に恒等プロ関手である．
\begin{definition}{ホム関手}\rm{}
    $C$を圏とする．圏$C$の\textrm{Hom functor}とは，次のように対応する関手$\hom$（または$\hom(-,-)$と表す）である．
    \begin{center}\begin{tikzcd}
        \hom(-,-) :C^{op}\times C \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathbf{Set} \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        (c,c') \ar[r, mapsto] & \mathrm{Hom}_C(c,c') \\
        (f,g):(d,c')\to (c,d') \ar[r, mapsto] & h:\mathrm{Hom}_C(c,c')\to\mathrm{Hom}_C(d,d')
    \end{tikzcd}\end{center}
    但し，写像$h$は$\mathbf{Set}$の射で，任意の$C$の射の組$(f:d\to c, g:c'\to d')$に対して定義され，以下のような対応をする写像である．（この対応$h$を関手$\hom$の値として$\hom_C(f,g)$と書くこともある．）
    \begin{center}\begin{tikzcd}
        h:\mathrm{Hom}_C(c,c') \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_C(d,d') \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        q:c\to c' \ar[r, mapsto] & g\circ q\circ f:d\to d'
    \end{tikzcd}\end{center}
    即ち，$C$上の任意の射の組$f,g$について，$f$のtargetと$g$のsourceの間の射$q$を，下の図を可換にする射$d\to d'$に写す対応である．
    \begin{center}\begin{tikzcd}
        c \ar[d, "q"'] & d \ar[l, "f"'] \ar[d] \\
        c' \ar[r, "g"'] & d'
    \end{tikzcd}\end{center}
    （第一変数$f$について引き戻して，第二変数$g$について押し出している感覚がある．）
\end{definition}

こうして定義したホム関手$\hom:C^{op}\times C\to \mathbf{Set}$は，第一変数が反変で第二変数が共変な双関手(bifunctor)である．つまり，第一引数／第二引数を固定すると，自然と共変／反変関手が定義される．$c\in C$を１つ選び出して，２つの関手$h^c:=\mathrm{Hom}(c,-):C\to\mathbf{Set},h_c:=\mathrm{Hom}(-,c):C^{op}\to\mathbf{Set}$を，以下のように構成できる．
\begin{center}\begin{tikzcd}
    h^c=\mathrm{Hom}(c,-):C \ar[r, "\simeq"] & 1\times C \ar[r, "c\times 1_C"] & C^{op}\times C \ar[r, "{\hom(-,-)}"] & \mathbf{Set} \\
    h_c=\mathrm{Hom}(-,c):C \ar[r, "\simeq"] & C^{op}\times 1 \ar[r, "1_C\times c"] & C^{op}\times C \ar[r, "{\hom(-,-)}"] & \mathbf{Set}
\end{tikzcd}\end{center}
但し，関手$c$は$1\ni 0\to c\in C$に写す包含定関手(constant functor / selection functor)$1\to C$とした．なお，圏$1$とは対象の集合を自然数$1=\{ 0\}$，射の集合を$\{ 1_0\}$とした単一対象圏である．

これはホム関手の分解(decompose)として捉えられて，次の図式は可換になる．
\begin{center}\begin{tikzcd}
    & \mathrm{Hom}_C(A,B) \ar[dd, "{\mathrm{Hom}(h,f)}"] \ar[dr, "{\mathrm{Hom}(h,B)}"] \ar[dl, "{\mathrm{Hom}(A,f)}"'] & \\
    \mathrm{Hom}_C(A,B') \ar[dr, "{\mathrm{Hom}(h,B')}"'] & & \mathrm{Hom}_C(A',B) \ar[dl, "{\mathrm{Hom}(A',f)}"] \\
    & \mathrm{Hom}_C(A',B') &
\end{tikzcd}\end{center}
それぞれの関手$\mathrm{Hom}_C(A,-)=h^A$を共変Hom関手（余前層），$\mathrm{Hom}_C(-,B)=h_B$を反変Hom関手（前層）と呼ぶ．
また，この可換図式の一番外側の四角形は，図式\ref{def-cd:15'}と見比べると，$C$の適当に与えられた射$h:A'\to A$毎に，２つのHom関手$\mathrm{Hom}_C(A,-),\mathrm{Hom}_C(A',-)$の値である$\mathbf{Set}$上の射$\mathrm{Hom}_C(A,f),\mathrm{Hom}_C(A',f)$の間を可換にしていて，
これが成り立つとは即ち，写像$\varphi := \mathrm{Hom}_C(h,-):C\to \mathrm{arr}(\mathbf{Set})$が２つの関手$\mathrm{Hom}_C(A,-),\mathrm{Hom}_C(A',-)$の自然変換（関手の射）となっていることを，上の可換図式が含意していることが分かる．

なお，Hom関手の間の自然変換は，全てこの形のものに限ることが分かる．（米田の補題\ref{Yoneda's-lemma}）
なお，値を集合の圏\textbf{Set}に取るのではなく，自身である圏$C$の内部に取る場合，これを内部Hom関手（定義\ref{def-closed-category}）という．

\subsection{忘却関手 forgetful fanctor / underlying functor}
圏$C$が別の圏$C'$（$\mathbf{Set}$など）のうち，特に付加的な構造持つものがなす圏とすると，その構造を忘れ去ることにより，自明な共変関手を構成することができる．これを忘却関手という．

\section{表現可能関手 representable functor}
\begin{quotation}
    Representable functors are ubiquitous.
    
    To a fair extent, category theory is all about representable functors and the other universal constructions: Kan extensions, adjoint functors, limits, which are all special cases of representable functors – and representable functors are special cases of these.
    \footnote{nLabのrepresentable functorのエントリ}
\end{quotation}
\subsection{表現可能関手の定義}
\begin{shadebox}\begin{definition}[表現可能関手]\label{def-representable functor}
    $C$を圏とする．集合の圏$\mathbf{Set}$への関手$F:C^{op}\to\mathbf{Set}$（または$C$上の前層）が表現可能であるとは，関手$F$が，対象$X\in C$が存在して，その反変ホム関手$h_X=\hom_C(-,X):C^{op}\to\mathbf{Set}$と同型となること．
    この時，関手$F$を\textbf{$X$によって表現される（反変）関手}といい，同型$\varphi :F\xrightarrow{\sim}h_X$を\textbf{表現}と呼ぶ．
\end{definition}\end{shadebox}

また，この双対的な概念，即ち
共変Hom関手$\mathrm{Hom}_C(X,-):C\to\mathbf{Set}$と同型な関手$F:C\rightarrow \mathbf{Set}$を$C$-余表現可能関手(corepresentable functor)（余前層）という．
また，この$X$は同型の違いを除いて一意的に決定され，\textbf{$F$の表現対象(representing object for F)}という．（命題\ref{Yoneda's-lemma-3}）

また，米田の補題（命題\ref{Yoneda's-lemma}）によれば，一般の関手$F:C^{op}\to\mathrm{Set}$に対して，関手の射$varphi: h_X\to F$は，ある一点$\xi\in F(X)$のみによって一意に定まる．即ち，組$(X,\xi)$が同型の違いを除いて一意に定まる．
この対象$X\in C$を\textbf{$F$の表現対象(representing object for $F$)}または\textbf{$F$の普遍対象(universal object for $F$)}といい，$\xi$を\textbf{$F$の普遍元(universal element for $F$)}という．

\subsection{反変冪集合関手は表現可能関手である．}

\begin{proposition}[$P^*$ is represented by 2]
    反変冪集合関手$P^*:\mathbf{Set}^{op}\to\mathrm{Set}$は，集合$2=\{ 0, 1\}$によって表現される．
    即ち，次の同型射$\varphi$が存在する．
    $$\varphi : P^*\xrightarrow{\sim} h_2=\hom_{\mathbf{Set}}(-,2)$$
\end{proposition}
\begin{proof}
    
\end{proof}

\chapter{関手の射と関手圏の様子}
関手の射のことを，歴史的には「自然変換」という．写像には階層がないが，圏論では階層を上がっていけるようだ．不思議だ．この観念をn-圏／n-射といい，これを考える理論をhigher order category theoryという．最近の流行りは４段目のinfinite categoryらしい．
\begin{quote}Frequently in modern mathematics there occur phenomena of "naturality": a "natural" isomorphism between two groups or between two complexes, a "natural" homeomorphism of two spaces and the like. We here propose a precise definition of the "naturality" of such correspondences, as a basis for an appropriate general theory. \footnote{S. Eilenberg and S. MacLane, Natural Isomorphisms in Group Theory, Proceedings of the National Academy of Sciences, 28(1942), 537-543.}\end{quote}

\begin{quote}Just as a functor is a morphism between categories, a natural transformation is a 2-morphism between two functors. \\ Natural transformations are the 2-morphisms in the 2-category Cat.\footnote{https://ncatlab.org/nlab/show/natural+transformation}\end{quote}
\section{関手の射の定義}
\begin{shadebox}\begin{definition}[関手の射]\rm{}
    $C,C'$を圏とし，$F,G:C\rightarrow C'$を関手とする．
    写像$\varphi : C\rightarrow M'$が存在して以下の２つの可換図式を充たす時，
    これを関手$F,G$間の関手の射という．
    元の圏$C$の対象$x\in C$にassignされる$M'$の関手の射$\varphi$による値$\varphi (x):F(x)\rightarrow G(x)$のことを「$\varphi$の成分(component of $\varphi$ at $x$)」という．

    この時，２つの関手$F,G:C\to C'$の間に自然変換(natural transformation)$\varphi :F\to G$が存在するといい，以下のように描かれる(denoted)ことがある．
    \begin{center}
        \begin{tikzcd}
            & {} \ar[dd, Rightarrow, "\varphi", shorten <= 1.9em, shorten >= 1.5em] &\\
            C \ar[rr, "F", bend left=30] \ar[rr, "G"', bend right=30] & & C'\\
            & {} &\\
        \end{tikzcd}
    \end{center}
\end{definition}\end{shadebox}

\begin{figure}[h]\begin{center}
    \caption{各$A\in C$に対して$\varphi (A):F_C(A)\rightarrow G_C(A)$を表す可換図式．つまり，各対象について，$F,G$で移った先の２つの対象を結ぶように射を選び取るように要請している可換図式．\label{def-cd:13}}
    \begin{tikzcd}
        {} \ar[dr, phantom, "\circlearrowright", near end] & C \ar[dl, "F_C"'] \ar[dr, "G_C"] \ar[d, "\varphi"] & {} \ar[dl, phantom, "\circlearrowright", near end] \\
    C' & M' \ar[l, "s'"] \ar[r, "t'"'] & C'
    \end{tikzcd}
\end{center}\end{figure}

\begin{figure}[h]\begin{center}
    \caption{２つの関手$F,G:C\to C'$の間に自然な"移り合いの関係"$\varphi (B)\circ F(f)=G(f)\circ\varphi (A)$があることを表す可換図式．\label{def-cd:15}}
    \begin{tikzcd}
        M \ar[r, "{(\varphi\circ t, F_M)}"] \ar[d, "{(G_M, \varphi\circ s)}"'] & M'_{s'}\underset{C'}{\times}{}_{t'}M' \ar[d, "c'"] \ar[dl, phantom, "\circlearrowright"] \\
        M'_{s'}\underset{C'}{\times}{}_{t'}M' \ar[r, "c'"'] & M'
    \end{tikzcd}
\end{center}\end{figure}
この可換図式は，任意の圏$C$の射$f:A\to B$について，圏$C'$上の次のような図式が可換になる条件と等価である．
\begin{figure}[h]\begin{center}\caption{任意の$C$の射$f:A\to B$についてこの図式が可換になる．これをnaturality squareと呼ぶこともある．\label{def-cd:15'}}\begin{tikzcd}
    F_C(A) \ar[r, "F_M(f)"] \ar[d, "\varphi (A)"'] & F_C(B) \ar[d, "\varphi (B)"]\\
    G_C(A) \ar[r, "G_M(f)"'] & G_C(B)
\end{tikzcd}\end{center}\end{figure}

\subsection{関手の射の合成}
３つの関手$F,G,H:C\rightarrow C'$に対して，
２つの関手の射$\varphi :F\rightarrow G, \psi :G\rightarrow H$の合成$\psi\circ\varphi$を，$C$の各元$A$に関して
$\psi\circ\varphi (A):=\psi (A)\circ\varphi (A):F(A)\xrightarrow{\varphi}G(A)\xrightarrow{\psi} H(A)$というように定義する．
１つ目の$\circ$は関手の射の合成，２つ目の$\circ$は圏$C'$の射としての合成であることに注意．
この定義は2-圏におけるvertical compositionという．

すると，定義の仕方により，合成$\psi\circ\varphi :C\to M'$は$A\in C$を$C'$の射$F_C(A)\to H_C(A)$に写すから，１つ目の可換図式\ref{def-cd:13}を充たす．
２つ目の可換図式\ref{def-cd:15}は，そもそも$\varphi, \psi$が関手の射であったから$C$の任意の射$f:A\to B$に対して次の図式が可換であり，そのことに含意されている．（下図の一番外側を廻る道が可換であること．）
\begin{center}\begin{tikzcd}
    F_C(A) \ar[r, "F_M(f)"] \ar[d, "\varphi (A)"'] & F_C(B) \ar[d, "\varphi (B)"]\\
    G_C(A) \ar[r, "G_M(f)"'] \ar[d, "\psi (A)"'] & G_C(B) \ar[d, "{\psi (B)}"] \\
    H(A) \ar[r, "H_M(f)"'] & H(B)
\end{tikzcd}\end{center}

\section{関手の同型／自然同型(natural equivalence)}
関手$F:C\to C'$について，関手の射$1_F:F\to F$を，任意の$A\in C$に対して圏$C'$の対象$F(A)$の単位射$1_F(A):F(A)\to F(A)$を対応させると定めると，これは関手の射の合成に関して単位的である．
関手の射$\varphi :F\rightarrow G$が，逆射$\phi :G\rightarrow F$（$\psi\circ\phi =1_F, \psi\circ\varphi =1_G$を充たす）を持つ時，これは関手の同型であるという．
従って，関手の射が同型である／可逆であるとは，各$A\in C$に対して対応する圏$C'$の射$\varphi (A):F(A)\rightarrow G(A)$がそれぞれ同型（可逆）で，逆射が$\psi (A):G(A)\to F(A)$であるあることに等しい．

\begin{proposition}[関手の同型の特徴付け]\label{prop-charactorization-natural-equavalence}
    関手$F,G:C\to C'$と関手の射$\varphi :F\to G$について，以下の２つの条件は同値である．\rm{}

    1.\, $\varphi$は関手の同型である．

    2.\, 任意の$A\in C$について，圏$C'$の射$\varphi (A):F(A)\to G(A)$は同型である．
\end{proposition}
\begin{proof}
    $1\to 2$は，上述の通り，定義の仕方そのものである．
    $2\to 1$は，各$A\in C$に対し，$\phi (A)$を$\varphi (A)$の逆射とすれば，写像$\phi :G\to F$が定まるが，これは$\varphi$の（関手の射としての）逆射に確かになっている．
\end{proof}

\section{関手圏\textrm{Funct}}
$C,C'$を圏として，対象を関手$C\rightarrow C'$の全て，射をその間の自然変換とすれば，これは圏をなす．
これを$\mathbf{Fun}(C,C'),\mathbf{Funct}(C,C'), {C'}^{C}, [C,D]\in \mathbf{Cat}$などと書く．

\section{関手圏の例}
図式の圏や，前層／層の圏は，関手圏の例である．

\section{関手の射の例１：値写像}\label{section-vectorspace-1}

圏$C=［有限次元\mathbb{R}-線型空間］$とし，次のように２つの関手$h^V,F:C\to\mathbf{Set}$を$V\in C$を固定した共変ホム関手$h^V:=\mathrm{Hom}_C(V,-)$と忘却関手$F$として定める．
すると，次のように定めた写像$\varphi :C\to \mathrm{arr}(\mathbf{Set})$は関手の射$\varphi ]h^V\to F$となっている．
各$W\in C$に対して，その値を次のような$\mathbf{Set}$の射として定める．
\begin{center}\begin{tikzcd}
    \varphi (W):h^V(W) \ar[r] \ar[d, equal] & G(W) \ar[d, equal] \\
    \mathrm{Hom}_C(V,W) \ar[d, phantom, "\rotatebox{90}{$\in$}"] & W \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    g:V\to W \ar[r, mapsto] & g(x)
\end{tikzcd}\end{center}
但し，$x$とは$V$の勝手な元で，この写像$\varphi (W)$は，各線型空間$W\in C$への（予め定めた）$V$からの線型写像の１つ１つを，$V$上の点$x$で取る値としてcodingするような写像になっている．
これは値写像(evaluation mapping)$\mathrm{ev}_x$の線型写像版とも見れる．\footnote{写像と点の役割が入れ替わっている．これは，数学で度々使われる重要な方法である．（斎藤毅『集合と位相』）}

\begin{proposition}[$\varphi$のwell-definedness] \label{prop-welldefinedness1}
    上記のように定義した関手の射$\varphi :h^V\to F$に対して，任意に取った$C$の射$f:U\to W$について，次の図式は可換になる．
    \begin{center}\begin{tikzcd}
        h^V(U) \ar[r, "{h^V(f)}"] \ar[d, "{\varphi (U)}"] & h^V(W) \ar[d, "{\varphi (W)}"] \\
        F(U) \ar[r, "{F(f)}"] & F(W)
    \end{tikzcd}\end{center}
\end{proposition}
\begin{proof}
    上の可換図式を書き直せば，
    \begin{center}\begin{tikzcd}
        \mathrm{Hom}_C(U,W) \ar[r, "f_*"] \ar[d, "{\varphi (U)}"] & \mathrm{Hom}_C(V,W) \ar[d, "{\varphi (W)}"] \\
        U \ar[r, "f"] & W
    \end{tikzcd}\end{center}
    となる．任意に$g\in\mathrm{Hom}_C(U,W)$と$x\in V$を取る．右回りでの合成写像による値は$f\circ g(x)$であり，左回りでの合成写像による値は$f(g(x))$である．$f,g$はいずれも写像であるから，これは成り立つ．
\end{proof}

一般に，こうして定義した関手の射$\varphi :C\to\mathbf{Set}$は同型ではない．そこで，次の例を考える．

\section{関手の射の例２}\label{section-vectorspace-2}

関手$h^V$を上記と同様に定義し，関手$G:C\to\mathbf{Set}$を次のように定義する．但し，$n\in\mathbb{N}$．
\begin{center}\begin{tikzcd}
    G:C \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathbf{Set} \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    W \ar[r, mapsto] & W^n \\
    f:U\to W \ar[r, mapsto] & f_*:U^n\to W^n
\end{tikzcd}\end{center}
但し，写像$f_*$は以下のように，$U^n$の各成分について$f:U\to W$を施す写像である．
\begin{center}\begin{tikzcd}
    f_*:U^n \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & W^n \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    (y_1,\cdots,y_n) \ar[r, mapsto] & (f(y_1),\cdots,f(y_n))
\end{tikzcd}\end{center}

次のように写像$\varphi :C\to \mathrm{arr}(\mathbf{Set})$を定める．$x_1,\cdots,x_n\in V$として，各$W\in C$を$\mathbf{Set}$上の射
\begin{center}\begin{tikzcd}
    \varphi (W):F(W)=\mathrm{Hom}_C(V,W) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & G(W)=W^n \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    g \ar[r, mapsto] & \left( g(x_1),\cdots,g(x_n)\right)
\end{tikzcd}\end{center}
この時，$\varphi$は２つの関手$h^V,G$の間に自然変換を定める．証明は命題\ref{prop-welldefinedness1}を一般化する形で達成される．

この時，$x_1,\cdots,x_n$が$V$の基底であるとき，射$\varphi$は可逆であることは簡単にわかるが，
実は射$\varphi$が可逆であるとき，必ず$x_1,\cdots,x_n$は$V$の基底である．つまり，命題\ref{prop-charactorization-base}が成り立つ．

\begin{screen}
    有限次元実線型空間$V$について，$x_1,\cdots,x_n\in V$が基底であることの特徴付け「$\phi$が関手の同型になること」を得た（命題\ref{prop-charactorization-base}）．
    これは言葉を変えれば，任意の有限次元実線型空間$W$への線型写像$g:V\to W$が，基底の行き先$(g(x_1),\cdots,g(x_n))\in W^n$によって完全に分類できることを，圏論的に定式化したものだと思える．
    議論の途中で，一次独立性などの概念や，「任意の$x\in V$に対して，$(a_1,\cdots,a_n)\in\mathbb{R}^n$が存在して，$x=a_1\cdot x_1 + \cdots + a_n\cdot x_n$とただ一通りに表せる．」などの$V$自身や，他の$C$の対象自身についての条件などは一度も現れていない．
\end{screen}

\chapter{圏の同値(equivalence)}
表現可能関手の定義\ref{def-representable functor}もそうであったが，関手同士の関係で，同型を除いて一意に定めることは出来ても，それ以上の同一関係があまり意味を持たないこともある．
２つの圏$C,C'$が同型であるとは，可逆な関手$F:C\to C'$が存在することである．そして，関手$F$が可逆であるとは，$1_C,1_{C'}$を恒等関手として，$F\circ G=1_{C'}$かつ$G\circ F=1_C$を充たす関手$G:C'\to C$が存在することである．
この時対象関数，射関数のそれぞれが写像として可逆であるため，圏が同型であるには，例えば射集合と対象集合とが互いに同じ濃度を持っている必要がある．
この圏が同型であるための条件を，関手の同型を使って緩めることを考える．圏の同値は，もう少し緩い意味での，しかし自然な「圏同士が本質的には同値」という状態を捉える概念となる．
この操作は本質的に圏の中の同値類に注目する行為になっている．そういう意味で，今まで出会った中で一番気持ちの良い同値関係かもしれない．相等関係という意味での，自明な同値関係とは違う．

どうしてこのような問題が生じたのかを考えたい，同型などの概念を宿していた圏自身が十分高次元になったからだろうか．

\section{圏の同値の定義}
\begin{shadebox}\begin{definition}[equavalence of categories]\rm{}
    ２つの圏$C,C'$が同値であるとは，互いに逆向きの関手$F:C\to C', G:C'\to C$と，その間の関手の同型$\varphi,\psi$の３つが存在し，次が成り立つこと．
    $$G\circ F\xrightarrow{\varphi}1_C,\hspace{3mm}F\circ G\xrightarrow{\psi}1_{C'}$$
    関手$F,G$間のこの条件を「同型の違いを除いて逆関手である(inverse to each other up to natural isomorphism)」とも言う．この時，$G$を$F$の準逆関手であるという．\footnote{nLabではこれをinverse functorと呼んでしまっている．}このとき，$F,G$を圏$C,C'$の同値であるという．
\end{definition}\end{shadebox}
即ち，$C$の対象$A$について，行って戻ってきた$G(F(A))$と元の$A$の間に必ず同型射$\varphi (A):G(F(A))\to A$が存在し，圏$C'$についても同様であること．

\section{圏の同値の特徴付け}

\begin{shadebox}\begin{definition}[忠実，充満関手]\rm{}
    $F:C\to C'$を関手とする．

    1)\, 任意の$A,B\in C$に対して，関手$F$が定める次の写像
    \begin{center}\begin{tikzcd}
        \mathrm{Mor}_C(A,B) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Mor}_{C'}(F(A),F(B)) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        f:A\to B \ar[r, mapsto] & F(f):F(A)\to F(B)
    \end{tikzcd}\end{center}
    が単射であるとき，関手$F$は\textbf{忠実(faithful)}であるという．全射であるとき，関手$F$は\textbf{充満(full)}であるという．可逆である時，\textbf{充満忠実(fully faithful)}であるという．

    2)\, 任意の$A'\in C'$に対して，$A\in C$が存在して同型射$F(A)\to A'$が圏$C'$上に存在するとき，$F$は\textbf{本質的に全射(essentially surjective (on objects), eso, dense)}であるという．
\end{definition}\end{shadebox}
1)の用語は射写像の属性についての術語，2)は対象写像についての術語となる．射写像の性質については，「全射」などの写像を連想させる用語が避けてあり，対象写像について使われている．

\begin{proposition}[圏の同値の特徴付け]\label{prop-charactorization of equavalence of categories}
    関手$F:C\to C'$に対して，次の２条件は同値である．\rm{}

    1)\, $F:C\to C'$は圏の同値である．

    2)\, $F$は充満忠実で，本質的に全射である．
\end{proposition}
即ち，上記のように定義した圏同値の概念は，「射の様子はもれなく対応していて，対象の方だけ，同型の範囲でズレがある（同型だった２つの対象が１つの対象にまとまっていたり，分裂していたり．）」という状況を指し，
射の様子に注目するという目的のある圏論にとっては，圏同士の関係で，同型よりもより自然な同値関係となっている．従って，一般に「圏の同値」と言った時，この関係を指す．
\begin{proof}{(AC)}
    
\end{proof}

\begin{lemma}[充満忠実関手は，射の可逆性を保存する．]
    $F:C\to C'$を関手とし，$f:A\to B$を$C$の射とする．次の２条件を考える．\rm{}

    1)\, $f:A\to B$は$C$の可逆な射（同型）である．

    2)\, $F(f):F(A)\to F(B)$は$C'$の可逆な射（同型）である．

    1)$\Rightarrow$2)は常に成り立ち，2)$\Rightarrow$1)は$F$が充満忠実なら成り立つ．
\end{lemma}
関手が充満忠実であるならば，互いに逆射であるような射の組は，互いに逆射である射の組に写すことが分かった．\footnote{実はこの条件は，$F$が充満忠実ではなくとも，$F$の射写像$F_M$が全単射であれば成り立つ．(2020/2/22)}

\begin{corollary}
    $F:C\to C'$を充満忠実関手とする．
    $$C_0':=\{ A'\in C'\mid A\in Cと同型F(A)\xrightarrow{\simeq}A'が存在する \}$$
    と置いて，$C_0'$を$C'$の充満部分圏とすると，$F$は圏の同値$F:C\to C_0'$を引き起こす．
\end{corollary}
\begin{proof}
    こうして作った$C_0'$への$F$が誘導する関手は，本質的に全射である．一方$C_0'$は充満部分圏であるから，誘導される関手$F:C\to C_0'$も充満忠実のままである．
\end{proof}

\section{圏の同値のwell-definedness}

\begin{proposition}[圏の同値のwell-definedness] \label{prop-welldefinedness equivalence of categories}
    圏の同値は，次の３条件を充たす．\rm{}

    1.\, 任意の圏$C$について，$C$と$C$は圏同値．

    2.\, 任意の圏$C,C'$について，$C$と$C'$が圏同値なら，$C'$と$C$も圏同値である．

    3.\, 任意の圏$C,C',C''$について，$C$と$C'$，$C'$と$C''$が夫々圏同値ならば，$C$と$C''$も圏同値である．
\end{proposition}

\section{同値な圏の例１：行列の圏と有限次元$\mathbb{R}$-線型空間の圏}

行列のなす圏$C_0$を定義する．対象の集合を$\mathbb{N}=\{0,1,2,\cdots\}$とし，その間の射を$n,m\in\mathbb{N}$に対して$\mathrm{Mor}_{C_0}(n,m)=M(m,n;\mathbb{R})$として定めと，
射の合成を行列の積とし，単位射を$I_n$倍写像として圏をなす．

関手$F:C_0\to C$を次のように定義する．$C=［有限次元\mathbb{R}-線型空間］$とする．
\begin{center}\begin{tikzcd}
    F:C_0 \ar[d, phantom, "\rotatebox{90}{$\in$}"] & C \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    n \ar[r, mapsto] & \mathbb{R}^n
    A\in M(m,n;\mathbb{R}) \ar[r, mapsto] & F(A)=f_A
\end{tikzcd}\end{center}
但し，写像$f_A$は，$x\in\mathbb{R}^n$を$Ax$に写す$A$倍写像である．
この時，次の命題は確かに成り立つ．
\begin{proposition}[関手$F$のwell-definedness]
    上記のように定義した関手$F:C_0\to C$に関して，次の２つの条件が成立する．\rm{}

    1.\, $F(AB) = F(A)\circ F(B)$

    2.\, $F(I_n) = 1_{F(I_n)}$
\end{proposition}
また，線型代数学から，次の命題が成り立つ．
\begin{proposition}
    関手$F$の射写像
    \begin{center}\begin{tikzcd}
        \mathrm{Mor}_{C_0}(n,m)=M(m,n;\mathbb{R}) \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_\mathbb{R}(\mathbb{R}^n,\mathbb{R}^m) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        A \ar[r, mapsto] & f_A:\mathbb{R}^n\to\mathbb{R}^m
    \end{tikzcd}\end{center}
    は可逆である．
\end{proposition}
従って，関手$F$は充満忠実である．
\begin{proposition}
    上記のように構成した関手$F$は本質的に全射である．
\end{proposition}
\begin{proof}
    $V\in C$を任意に取る．$V$は有限次元の線型空間だから，自然数$n$と基底$x_1,\cdots,x_n\in V$が存在する．
    射$F(n)=\mathbb{R}^n\to V$を，
    $$\left( \begin{array}{c}
        a_1 \\ \vdots \\ a_n
    \end{array} \right)\mapsto a_1\cdot x_1 + \cdots + a_n\cdot x_n$$
    で定めると，これは同型になる．（基底の特徴付け）
    従って，任意の$V\in C$について，$n\in C_0$が存在して$F(n)\simeq V$となる．
\end{proof}
以上より，関手$F$は充満忠実で本質的に全射な関手だから，これは圏$C,C_0$の同値である．

\section{同値な圏の例２：有限次元$\mathbb{R}$-線型空間の圏とその双対空間の圏}

関手${}^V:C^{op}\to C$(check)を定める．最後に，これが圏の同値になることを説明する．
\begin{center}\begin{tikzcd}
    {}^V:C\ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & C \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    V \ar[r, mapsto] & V^V=\mathrm{Hom}_\mathbb{R}(V,\mathbb{R})\\
    f:V\to W \ar[r, mapsto] & f^V:W^V\to V^V
\end{tikzcd}\end{center}
なお，写像$f^V$は
\begin{center}\begin{tikzcd}
    f^V:W^V \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & V^V \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    g:W\to\mathbb{R} \ar[r, mapsto] & g\circ f:V\to\mathbb{R}
\end{tikzcd}\end{center}
である．線型写像の合成は線型写像であるから，$g\circ f$は確かに$\mathbb{R}$-線型形式である．
この時，次の命題が成り立つ．
\begin{proposition}[関手${}^V$のwell-definedness]
    上記のように定めた関手${}^V$について，次の２条件が成り立つ．\rm{}

    1.\, $(g\circ f)^V = f^V\circ g^V$

    2.\, $(1_V)^V = 1_{V^V}$
\end{proposition}


関手$F$は前節で定義した圏の同値だとする．関手${}^V$が圏の同値であることを示すに当たって，
まず関手${}^t:C^{op}_0\to C_0$を定義し，これが圏の同型であることを示す．
次に，圏の同型$\varphi :F\circ {}^t\to {}^V\circ F$が存在することを示す．
すると，次の図式から，圏の同型${}^t$は圏の同値でもあるから，圏の同値の推移律（命題\ref{prop-welldefinedness equivalence of categories}）より，関手$F\circ {}^t$も圏の同値．これと同型な${}^V\circ F$も圏の同値．従って，${}^V$が圏の同値だとわかる．
\begin{center}\begin{tikzcd}
    C^{op}_0 \ar[r, "F"] \ar[d, "t"', "\simeq"] & C^{op} \ar[d, "{}^V"] \\
    C_0 \ar[r, "F"'] & C
\end{tikzcd}\end{center}
なお，この図式は可換ではないが，同型の違いを除いて可換であるから，2-可換であるという．

関手${}^t:C^{op}_0$を，次のように，対象写像は恒等写像，射写像は各射である行列をその転置行列に写す写像として定める．
\begin{center}\begin{tikzcd}
    {}^t:C^{op}_0 \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & C_0 \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    n \ar[r, mapsto] & n \\
    A \ar[r, mapsto] & {}^t\! A
\end{tikzcd}\end{center}
これは次の命題を充たす．
\begin{proposition}[関手${}^t$のwell-definedness]
    上記のように定めた関手${}^t$について，次の２条件が成り立つ．\rm{}

    1.\, ${}^t\! (AB) = {}^t\! B{}^t\! A$

    2.\, ${}^t\! I_n = I_n$
\end{proposition}
これは非常に見慣れた，行列の転置についての計算規則である．従って，確かに関手${}^t$を定めた．

次に，この関手${}^t$は可逆であり，逆射は自身${}^t$となる対合である．なぜなら，対象写像は$C_0$上の恒等写像であり，その逆写像は自分自身である．
各行列にその転置行列を対応させる射写像についても同様である．
従って，関手${}^t$は圏の同型である．

ここで，次の命題を証明する．
\begin{proposition}
    ２つの関手$F\circ {}^t, {}^V\circ F$の間に関手の自然同型$\varphi :F\circ {}^t\xrightarrow{\simeq} {}^V\circ F$が存在する．
\end{proposition}
\begin{proof}
    自然同型$\varphi$を，各$n\in C_0^{op}$に対してその成分を，圏$C$の同型射
    \begin{center}\begin{tikzcd}
        \varphi (n):F\circ {}^t(n) =\mathbb{R}^n \ar[r, "\simeq"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & (\mathbb{R}^n)^V={}^V\circ F(n) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        x \ar[r, mapsto] & f_x:\mathbb{R}^n\to\mathbb{R}
    \end{tikzcd}\end{center}
    として定める．ただし，線型写像$f_x\in(\mathbb{R}^n)^V$は，各$y\in\mathbb{R}^n$に対して，その$x$に対する標準内積$x\cdot y\in\mathbb{R}$を対応させる線型写像である．（横ベクトル$x$を左から行列積で掛けるという$x$倍写像）．
    これは，任意の$C_0^{op}$の射$A\in M(m,n;\mathbb{R})$に対して，次の図式を可換にする．
    \begin{center}\begin{tikzcd}
        \mathbb{R}^m \ar[r, "\varphi (m)"] \ar[d, "\times {}^t\! A"'] & (\mathbb{R}^m)^V \ar[d, "\times (Ax)^V"] \\
        \mathbb{R}^n \ar[r, "\varphi (n)"'] & (\mathbb{R}^n)^V
    \end{tikzcd}\end{center}
    従って，$\varphi$は確かに関手の同型$\varphi :F\circ {}^t\xrightarrow{\simeq} {}^V\circ F$である．
\end{proof}

以上より，圏の同値関係の推移律より，関手${}^V:C\to C^{op}$は確かに圏の同値である．

なお，この事実を示すのに，次の命題を示すことによって達成しても良い．
\begin{proposition}[再双対]
    関手${}^V\circ {}^V$を次のように定めると，関手の同型$1_C\to {}^V\circ {}^V$が存在する．
    \begin{center}\begin{tikzcd}
        {}^V\circ {}^V:C \ar[r, "{}^V"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & C^{op} \ar[r, "{}^V"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & C \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        V \ar[r, mapsto] & V^V \ar[r, mapsto] & (V^V)^V =: V^W
    \end{tikzcd}\end{center}
    ただし，空間$V^W$は線型空間$V$の再双対といい，$V^W=\mathrm{Hom}_\mathbb{R}(V^V,\mathbb{R})=\mathrm{Hom}_\mathbb{R}(\mathrm{Hom}_\mathbb{R}(V,\mathbb{R}),\mathbb{R})$という線型汎関数の空間である．
\end{proposition}
すると，${}^V$は自身を準逆関手とした圏の同値であるとわかる．

\chapter{普遍性と極限}
まず普遍性について考える．極限は，「普遍性による構成」の特別な場合となる．
普遍性や随伴を考える前に，米田の補題と表現可能性(representability)を考える．
\begin{quotation}
    Representability is one of the most fundamental concepts of category theory, with close ties to the notion of adjoint functor and to the Yoneda lemma.
    It is the crucial concept underlying the idea of universal property; thus for example crucial concepts such as “limit”, “colimit”, “exponential object”, “Kan extension” and so on are naturally expressed in terms of representing objects.
    The concept permeates much of algebraic geometry and algebraic topology.\footnote{nLabのrepresentable functorのエントリ}
\end{quotation}

\section{表現可能関手と米田の補題：前層の圏の様子}
$C$を圏とする．関手圏（$C$-前層の圏）$\mathbf{Fun}(C^{op},\mathbf{Set})=:C'$の中での表現可能関手（圏$C'$の対象の中でも，ある特定の反変ホム関手と同型の差しかない対象）の役回りを考察する．
これを，適当な対象$A\in C$によって表現される反変ホム関手$h_A:C^{op}\to\mathbf{Set}$と，一般の反変関手$F:C^{op}\to\mathbf{Set}$との間の射（これは関手圏$C'$上の射なので，自然変換に当たる）を考えることによってする．

\subsection{場面設定}

$C$を圏とする．その上の前層の圏$[C^{op},\mathbf{Set}]$を$C'$と置く．
次の関手$C\to C'$を構成し，これを調べることで，一般の圏とその前層との間の関係を探ることとする．

\begin{definition}[Yoneda embedding]
    次の，圏$C$の対象$A$を，$A$で表現された前層$h_A=\hom_C(-,A)$へと写す関手$y:C\to C'$を米田の埋め込みという．
    \begin{center}\begin{tikzcd}
        C \ar[r, "y"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & C' \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        A \ar[r, mapsto] & h_A \\
        f:B\to A \ar[r, mapsto] & f^*:h_A\to h_B
    \end{tikzcd}\end{center}
    ただし，写像$f^*:h_A\to h_B$は，$g\in h_A=\mathrm{Hom}_C(-,A)$を$g\circ f\in h_B$に写す写像である．
    このように定めた関手$y$が実は充満忠実となる（系\ref{Yoneda's-lemma-1}），即ち，圏$C$と前層の圏$C'$とが似通っていることが，米田の補題\ref{Yoneda's-lemma}の系として得られる．
\end{definition}

さて，$A\in C$を勝手にとって，その関手$y:C\to C'$による値$h_A=\hom_C(-,A) \in C'$と，一般の反変関手（前層）$F\in C'$との関係を考える．
この時，$a\in F(A)$を勝手に１つ取る毎に，この２つの共変Hom関手$h_A,F:C^{op}\to \mathbf{Set}$の間の自然変換（関手の射）$\varphi_a:h_A\to F$が構成できることを説明する．

各$X\in C$に対して，２つの関手のそれぞれが$\mathbf{Set}$上で取る値$h_A(X)$と$F(X)$の間に，射$\varphi (X):h_A(X)\to F(X)$を構成する規則を与えれば良い．
しかしこの時，前者は$h_A(X)=\mathrm{Hom}_C(X,A)$であり，元として$C$の射$g:X\to A \in \mathrm{Hom}_C(X,A)$などが取れるが，後者$F(X)$は全く素性不明の集合であり，$g\in\mathrm{arr}(C)$に$F(X)$の何を対応させれば良いかはこのままでは考えられない．
そこで，$g:X\to A\in h_A(X)$を反変関手$F:C^{op}\to\mathbf{Set}$で写した時の値である，写像$F(g):F(A)\to F(X)$が値を$F(X)$に取ることを利用して，勝手な$F(A)$の元を$a\in F(A)$とすることで，$g\in h_A$に対して$F(g)(a)\in F(X)$を対応させることで，自然変換の$X\in C$に対する成分$\varphi_a(X)$を定める．
\begin{center}\begin{tikzcd}
    h_A(X)=\mathrm{Hom}_C(X,A) \ar[r, "\varphi_a(X)"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & F(X) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    g:X\to A \ar[r, mapsto] & F(g)(a)(=g^*aなどとも書く)
\end{tikzcd}\end{center}
こうして定義した自然変換$\varphi_a$は確かに自然変換となることを確認する．任意の$f:Y\to X\in C^{op}$について，次の図式が可換になれば必要十分．
\begin{center}\begin{tikzcd}
    h_A(X) \ar[r, "\varphi_a(X)"] \ar[d, "f^*"'] & F(X) \ar[d, "F(f)"] \\
    h_A(Y) \ar[r, "\varphi_a(Y)"] & F(Y)
\end{tikzcd}\end{center}
これは，等式$F(g\circ f)(a)=F(f)(F(g)(a))=F(f)\circ F(g)(a)$の成立を要請しているが，$F$は反変関手$C^{op}\to\mathbf{Set}$であったから，常に$F(g\circ f)=F(f)\circ F(g)$が成り立つのであった．
よって確かに，関手の射$\varphi_a:h_A\to F\hspace{2mm}(a\in F(A))$を定義できた．これは，$F(A)$の元$a$の取り方に依らないから，結局は次のような対応$\varphi$を定めたことに等しい．（\textbf{Set}上の射）
\begin{center}\begin{tikzcd}
    \varphi :F(A) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Nat}_{C'}(h_A,F)=\mathrm{Hom}_{C'}(h_A,F) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    a \ar[r, mapsto] & \varphi_a
\end{tikzcd}\end{center}
圏$C'$は関手の圏$C'=\mathbf{Fun}(C^{op},\mathbf{Set})$であったから，その上のホム集合とは，自然変換のことである．これを強調したい時，$\mathrm{Nat}_{C'}(h_A,F)$とも書く．

\subsection{米田の補題}

ここで，実のところ，$C'$上の，反変ホム関手$h_A$から一般の対象$F$への写像の集合，即ち２つの前層$h_A,F$間の自然変換は，全て上で議論したこの$\varphi$のタイプで尽くされることがわかる．
この事実を，米田の補題と呼ぶ．
\begin{shadebox}\begin{theorem}[米田の補題：前層の圏上で，Hom関手から出る射についての法則]\label{Yoneda's-lemma}\rm{}
    $C$を圏とし，$F:C^{op}\to\mathbf{Set}$を反変関手（前層）とする．
    任意に取った$A\in C$に対して$h_A:C^{op}\to\mathbf{Set}$は，$A$が表現する反変Hom関手$h_A=\mathrm{Hom}_C(-,A)$とすると，上で定義した次の写像は可逆である．
    \begin{center}\begin{tikzcd}
        \varphi :F(A) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Nat}_{C'}(h_A,F)=\mathrm{Hom}_{C'}(h_A,F) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        a \ar[r, mapsto] & \varphi_a:h_A\to F
    \end{tikzcd}\end{center}
    各$a\in F(A)$に対する$\varphi$の値である関手の射$\varphi_a:h_A\to F$を，\textbf{普遍元(universal element)$a$が定める射}と呼ぶ．
\end{theorem}\end{shadebox}
\begin{remark}
    純粋な圏論では，米田の補題の主張は米田の埋め込み$y:C\to C'$を使って，次のように書かれる．
    任意の$X$と$c\in C$について，$$\mathrm{Hom}_{[C^{op},\mathbf{Set}]}(y(c),X)\simeq X(c)$$
    前層$X$の$c\in C$での値である集合と，$c$を表現する前層$h_c$と$X$の間の射の集合とは，集合として同型であること主張している．
\end{remark}
\begin{remark}\rm{}
    米田の補題の双対的な主張は，$C$を圏とし，$F:C\to\mathbf{Set}$を共変関手とした時，$A\in C$が表現する共変Hom関手$h^A=\mathrm{Hom}_C(A,-)$が存在して，以下の写像が可逆になる．
    \begin{center}\begin{tikzcd}
        \varphi :F(A) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_{C'}(h^A,F) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        a \ar[r, mapsto] & \varphi_a:h^A\to F
    \end{tikzcd}\end{center}
    ただし，関手の射$\varphi_a$（の各成分）は，以前は反変的なものだったが，この場合は共変的なものである．
    \begin{center}\begin{tikzcd}
        \varphi_a(X):h^A(X)=\mathrm{Hom}_C(A,X) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & F(X) \ar[d, phantom, "\rotatebox{90}{$\in$}"]\\
        g:A\to X \ar[r, mapsto] & F(g)(a)=g_*a
    \end{tikzcd}\end{center}
\end{remark}
\begin{proof}
    逆向きの射$\psi$を次のように定める．
    \begin{center}\begin{tikzcd}
        \psi:\mathrm{Hom}_{C'}(h_A,F) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & F(A) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        \xi:h_A\to F \ar[r, mapsto] & \xi(A)(1_A)
    \end{tikzcd}\end{center}
    
    すると，$\psi\circ\varphi =1_{F(A)}$となる．なぜなら，各$a\in F(A)$に対して，$\psi\circ\varphi(a)=\psi(\varphi_a)$は，$\varphi_a$の$A$成分$\varphi_a(A):h_A(A)=\mathrm{End}_C(A)\to F(A)$の$1_A$での値，即ち$F(1_A)(a)=1_{F(A)}(a)=a$である\footnote{最初の等号は$F$が関手であることによる．}．
    次に$\varphi\circ\psi =1_{\mathrm{Hom}_{C'}(h_A,F)}$ついて考える．

    $\xi\in\mathrm{Hom}_{C'}(h_A,F)$を自然変換とする．$\varphi(\xi)=\xi(A)(1_A)=:a$とすると，$\psi(a)=\varphi_a$である．
    このとき，任意に取った$X$と$g:X\to A\in h_A(X)$について，この普遍元$a=\xi(A)(1_A)$が定める自然変換$\varphi_a$の$X$成分による値$F(g)(a)=F(g)(\xi(A)(1_A))=F(g)\circ \xi(A)(1_A)$と，元の自然変換$\xi$の$X$成分による$g$の値$\xi (X)(g)$が一致することを確かめたい．
    ここで，$\xi:h_A\to F$は関手の射であるから，次の図式(naturality square)は可換である．
    \begin{center}\begin{tikzcd}
        h_A(A) \ar[r, "\xi(A)"] \ar[d, "h_A(g)"'] & F(A) \ar[d, "F(g)"] \\
        h_A(X) \ar[r, "\xi(X)"] & F(X)
    \end{tikzcd}\end{center}
    ここで，$1_A\in h_A(X)$の２通りの値を比べてみると，時計回りでは$\xi(A)(1_A)=a$に写されてから，$F(g)(a)$即ち自然変換$\varphi_a$の$X$成分の値に他ならない．
    次に，反時計回りでは，$h_A$は反変Hom関手であることに注意して，\rm{}$h_A(g)(1_A)=1_A\circ g=g$に写されてから，$\xi(X)(g)$に至る．これは自然変換$\xi$の$X$成分の値に他ならない．
    図式は可換だから，$F(g)(a)=\xi (X)(g)$は任意の$X$と$g\in h_A(X)$について成り立つことがわかった．
    以上より，$\psi$は確かに$\varphi$の逆射となっており，$\varphi$は可逆である．
\end{proof}
従って，証明によって得られた知見として，上記の写像$\varphi$は次のように分解できる．
\begin{center}\begin{tikzcd}
    \mathrm{Hom}_{[C^{op},\mathbf{Set}]}(h_A,F) \ar[r, "|_C"] & \mathrm{Hom}_C(h_A(A), F(A)) \ar[r, "ev_{1_A}"] & F(A)
\end{tikzcd}\end{center}

\subsection{前層の射の例１}
今までの議論とは双対的な設定で考える，即ち共変Hom関手（余前層）の方で議論をする．

$C=\mathbf{Mon}$とし，$F:C\to\mathbf{Set}$を忘却関手とする．
$A=(\mathbb{N},+,0)\in C$とすると（こちらも今後$A$の代わりに$\mathbb{N}$と書く），$h^A=\mathrm{Hom}_C(A,-)$はこの対象から出る射全体の集合となる．
普遍元$a\in F(\mathbb{N})=\mathbb{N}$として$1$を取る．すると，$1$を普遍元として定まる自然変換は，$M\in C$に対して
\begin{center}\begin{tikzcd}
    h^\mathbb{N}(M)=\mathrm{Hom}_C(\mathbb{N},M) \ar[r, "\varphi_1(M)"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & F(M)=M\mathrm{(underlying)} \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    f:\mathbb{N}\to M \ar[r, mapsto] & F(f)(1)=f(1)
\end{tikzcd}\end{center}
を成分とする．この自然変換は，勝手なモノイド$M$からの射$\mathbb{N}\to M$のそれぞれを，$1\in\mathbb{N}$で取る値，即ちその単位元（台集合$M$の元として）へと写している．

すると，今回この自然変換は可逆となる．
\begin{proposition}[モノイドの圏の忘却関手は，（余）表現可能関手である．]\rm{}
    $C=\mathbf{Mon}$とし，忘却関手$F:C\to\mathbf{Set}$と$\mathbb{N}$を表現する共変Hom関手$h^\mathbb{N}$とは，自然同型である．
\end{proposition}
\begin{proof}
    自然変換$\varphi_1$の逆射$\psi_1$を構成することによって証明する．全ての$M\in C$に対して，
    \begin{center}\begin{tikzcd}
        M\mathrm{(underlying)} \ar[r, "\psi_1(M)"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_C(\mathbb{N},M)  \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    x \ar[r, mapsto] & g:\mathbb{N}\ni n\mapsto x^n\in M
    \end{tikzcd}\end{center}
    とすれば，これは$\varphi_1(M)$の逆射となっている．これを確認する．

    $f:\mathbb{N}\to M　\in\mathrm{Hom}_C(\mathbb{N},M)$を任意に取る．モノイド$M$の積を$\cdot$とし，その繰り返しを冪として表すと，
    $$\psi_1\circ\varphi_1(f)=\psi_1(f(1))=g:\mathbb{N}\ni n \mapsto f(1)^n \in M$$
    であるが，この写像$g$は$f(n)=f(1+1+\cdots +1)=f(1)^n\in M$より，$f$そのものである．
    逆に，$x\in M$を任意に取る．
    $$\varphi_1\circ\psi_1(x)=\varphi_1(f:\mathbb{N}\ni n\mapsto x^n\in M)=f(1)=x$$
    より，確かに$\varphi_1(M)$と$\psi_1(M)$は互いに逆射．よって命題\ref{prop-charactorization-natural-equavalence}より，$\varphi_1$は関手の同型である．
\end{proof}

\begin{screen}
    忘却関手$F:\mathbf{Mon}\to\mathbf{Set}$とモノイド$M$を表現する共変Hom関手には，その単位元$e\in M$を普遍元とする自然同型が存在する．
\end{screen}

\subsection{前層の射の例２}\label{section-vectorspace-base}

$C=\mathbf{FinVect}_\mathbb{R}$とし，$n$を勝手な自然数とする．
$C$の勝手な対象を$V$とし，普遍元として$x=(x_1,\cdots,x_n)\in V^n=F(V)$を取る．
\ref{section-vectorspace-1}節で定めた共変Hom関手$h^V$と，\ref{section-vectorspace-2}節で定めた関手$G:C\ni W\mapsto W^n\in\mathbf{Set}$との間の自然変換$\varphi_x:h^V\to G$の$W\in C$成分は次のようになる．
\begin{center}\begin{tikzcd}
    h^V(W)=\mathrm{Hom}_\mathbb{R}(V,W) \ar[r, "\varphi_x(W)"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & W^n=G(W) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
    f:V\to W \ar[r, mapsto] & \left( f(x_1),\cdots,f(x_n) \right)
\end{tikzcd}\end{center}
このとき，次の命題が成立する．

\begin{proposition}[線型空間の基底の圏論的特徴付け]\rm{}\label{prop-charactorization-base}
    上記の状況の下で，次の２つの条件は同値である．

    1.\, $x$は$V$の基底である．

    2.\, $x$は関手の同型$\varphi_x :h^V\to G$を定める．
\end{proposition}
これを示すのに，次の命題を用いる．米田の補題を，$B\in C$として$F=h_B$に対して適用すると，次の主張が導かれる．
\begin{shadebox}\begin{corollary}[米田の補題の系１：Hom関手の間の自然変換] \label{Yoneda's-lemma-1}\rm{}
    圏$C$に対して，任意の対象$A,B\in C$について，次の写像（\textbf{Set}の射）$\varphi$は可逆である．
    \begin{center}\begin{tikzcd}
        F(A)=h_B(A)=\mathrm{Hom}_C(A,B) \ar[r, "\varphi"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_{[C^{op},\mathbf{Set}]}(h_A,F=h_B) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        f:A\to B \ar[r, mapsto] & \varphi_f=f_*:h_A\to h_B
    \end{tikzcd}\end{center}
    これは，$\mathrm{Hom}_C(B,A) $の各元$f$に対して，それから生成される自然変換$\varphi=f_*:h_A\to h_B$を対応させる規則である．ただし，関手の射$f_*$は，各$X\in C$成分を以下のように与えるものである．
    \begin{center}\begin{tikzcd}
        h_A(X)=\mathrm{Hom}_C(X,A) \ar[r, "f_*(X)"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & h_B(X)=\mathrm{Hom}_C(X,B) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        g:X\to A \ar[r, mapsto] & f\circ g:X\to B
    \end{tikzcd}\end{center}
    なお，この対応が，$\mathrm{Hom}_C(X,A)$の元$g:X\to A$に対して，$h_B(g):h_B(A)\to h_B(X)$の点$f:A\to B$での値を対応させていることに注意．（$h_B$とは，\ref{section-hom-functor}節で定義した共変Hom関手であることに注意．）
\end{corollary}\end{shadebox}
\begin{remark}\rm{}
    この系の双対的な主張は以下の通りである．米田の補題（命題\ref{Yoneda's-lemma}）の双対的な主張に$F=h^B$と代入して考えると，次の可逆な写像を得る．
    \begin{center}\begin{tikzcd}
        \varphi :h^B(A)=\mathrm{Hom}_C(B,A) \ar[r, "\sim"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_{[C,Set]}(h^A,h^B) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        f:B\to A \ar[r, mapsto] & \varphi_f=f^*:\mathrm{Hom}_C(A,-)\to\mathrm{Hom}_C(B,-)
    \end{tikzcd}\end{center}
\end{remark}
\begin{proof}
    まず，1$\Rightarrow$2を証明する．今，$x=(x_1,\cdots,x_n)$は$V$の基底であるとする．この時に，任意に取った$W\in C=\mathbf{FinVect}_\mathbb{R}$に対して$\varphi_x$の成分
    \begin{center}\begin{tikzcd}
        h_V(W)=\mathrm{Hom}_\mathbb{R}(V,W) \ar[r, "\varphi_x(W)"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & W^n=G(W) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        g:V\to W \ar[r, mapsto] & \left( g(x_1),\cdots,g(x_n) \right)
    \end{tikzcd}\end{center}
    の可逆性を示せば，命題\ref{prop-charactorization-natural-equavalence}より，関手の射$\varphi_x$自体も可逆とわかる．この写像は，線型写像$g:V\to W$を，$V$の基底$x$の$W$での行き先を用いて分類している写像だということに注目する．

    そこで，写像（\textbf{Set}上の射）$\varphi_x(W)$に対して，逆向きの写像
    \begin{center}\begin{tikzcd}
        \psi(W) : W^n \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_\mathbb{R}(V,W) \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        y=(y_1,\cdots,y_n) \ar[r, mapsto] & g:V\to W
    \end{tikzcd}\end{center}
    を，$V$の任意の元$a_1\cdot x_1+\cdots +a_n\cdot x_n\in V$に対して（$x$は$V$の基底なので，任意の実数$a_1,\cdots,a_n\in\mathbb{R}$に対してこれは任意の$V$の元の表示になっている），$g(a_1\cdot x_1+\cdots +a_n\cdot x_n)=a_1\cdot y_1+\cdots +a_n\cdot y_n\in W$を対応させる写像$g$を，$\psi(W)$の$y$での値として取るように定義する．
    （なお，この時，$g$は確かに$\mathbb{R}$-線型写像になっている．これを$y\in W^n$の定める写像と呼ぶ．）
    こうして構成した$\psi(W)$はいつでも$\varphi_x(W)$の逆射になっていることを示す．

    $\varphi_x(W)\circ \psi(W)=1_{\mathrm{Hom}_\mathbb{R}(V,W)}$は，勝手に取った$g\in\mathrm{Hom}_\mathbb{R}(V,W)$に対して，$\varphi_x(W)$による値は$\left( g(x_1),\cdots,g(x_n) \right)$，この$\psi(W)$による値は$g(x_1),\cdots,g(x_n)$の定める写像になる．これは元の写像$g$に他ならない．
    $\psi(W)\circ \varphi_x(W)=1_{W^n}$は，勝手に取った$y\in W^n$に対して，これが定める写像$g$の$\varphi_x(W)$による値は，$y$であるから従う．

    次に，2$\Rightarrow$1を示す．$\mathbb{R}^n\in\mathbf{Set}$の標準基底を$e=(e_1,\cdots,e_n)$とおく．すでに証明した1$\Rightarrow$2の主張により，$\varphi_e:h^{\mathbb{R}^n}\to G$は関手の同型である．
    この時，次の（関手圏$[C,\mathbf{Set}]$上の）図式を可換にする射$\varphi_e^{-1}\circ\varphi_x:h^V\to h^{\mathbb{R}^n}$が存在する．
    \begin{center}\begin{tikzcd}
        h^{\mathbb{R}^n} \ar[r, "\varphi_e"] & G \\
        h^V \ar[u, dashed] \ar[ur, "\varphi_x"']
    \end{tikzcd}\end{center}
    系\ref{Yoneda's-lemma-1}の双対的な命題より，写像
    \begin{center}\begin{tikzcd}
        \mathrm{Hom}_C(\mathbb{R}^n,V) \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathrm{Hom}_{[C,\mathbf{Set}]}(h^V,h^{\mathbb{R}^n}) \ar[d, phantom, "\rotatebox{90}{$\in$}"]\\
        f:\mathbb{R}^n\to V \ar[r, mapsto] & \varphi_f=f^*:h^V\to h^{\mathbb{R}^n}
    \end{tikzcd}\end{center}
    は可逆になる．即ち，或る$f:\mathbb{R}^n\to V\in\mathrm{Hom}_C(\mathbb{R}^n,V)$がただ一つ存在して，上の図を可換にする（$f^*=\varphi_e^{-1}\circ\varphi_x$）．
    すると，$x$は，同型$f:\mathbb{R}^n\to V$による$e$の像であるから，定義よりこれは基底であることがわかった．
\end{proof}
\begin{shadebox}\begin{definition}[基底の定義（参考）]\rm{}
    $K$を体とし，$V\in\mathbf{FinVect}$を$K$-線型空間とし，$x_1,\cdots,x_n\in V$とする．$K^n\in\mathbf{Set}$を直積集合とし，その間の写像$f_x$を次のように定める．\footnote{こんな書き方をしたが，暗黙のうちに$V$を\textbf{Set}上に移動して，$f$は射として定めてないか？}
    \begin{center}\begin{tikzcd}
        f_x:K^n \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & V \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        (a_1,\cdots,a_n) \ar[r, mapsto] & a_1\cdot x_1+\cdots +a_n\cdot x_n
    \end{tikzcd}\end{center}
    この時，以下の２つの条件は同値であり，この同値な条件を満たす$x_1,\cdots,x_n$を$V$の基底と呼ぶ．

    1.\, $\forall x\in V\, \exists ! (a_1,\cdots,a_n)\in K^n \, [\, x=a_1\cdot x_1+\cdots +a_n\cdot x_n \,]$

    2.\, $f_x$は可逆．
\end{definition}\end{shadebox}

\begin{screen}
    $x$が$n$次元線型空間$V$の基底であるとは，$V$が表現する共変Hom関手$h^V:C\to\mathbf{Set}$と，$n$次元線型空間を$n$個の直積の集合と見なし，その間の線型写像は基底の定める写像とする「線型空間をベクトルの空間へと対応させる関手」$G:C\to\mathbf{Set}$とが，同型になるような$x$の取り方のことである．
    $V$内で「基底」を取ると，圏$C$を，我々の馴染み深い$\mathbf{Set}$上で調べることが可能になる．
\end{screen}

\subsection{前層の射の例３：共通部分の集合演算と論理積}

$X$を全体集合として，$A,B\subset X$の共通部分を取る演算は，$X$の冪集合$P(X)$上に１つ定められた写像$P(X)\times P(X)\to P(X)$に等しい．
さらに，これを$X\in\mathbf{Set}$についての成分と見ると，共通部分を取るという演算は，１つの自然変換$\cap :(P,P)\to P$を定めることがわかる．
これを集合の圏の前層の圏$[Set^{op},Set]$の射として調べることで，共通部分を取るという集合演算をより深く理解することを考える．

\begin{screen}\rm{}
    自然変換$\cap$は，圏$[\mathbf{Set}^{op}, \mathbf{Set}]$において，Bool代数$2$上の演算$\wedge$を普遍元として定まる自然変換$\wedge\circ :h_{2\times 2}\to h_2$と，自然に同一視される．\footnote{3/11/2020}
\end{screen}

\subsection{米田の補題の系}

米田の補題\ref{Yoneda's-lemma}は，前層の圏$C'=[C^{op},\mathbf{Set}]$において，反変Hom関手$h_A$という対象と一般の対象$F$の間の射$\varphi_a:h_A\to F$は，完全に$a\in F(A)$で添字づけられることを主張している．
これは，その特定の自然変換$\eta$の$A$成分$\eta(A)$の$1_A$で取る値に他ならない．
即ち，$\eta:h_A\to F$が自然変換であるであるということ，前層の圏の射であるという時点で，その条件(naturality condition)は十分に強く，$\eta(A)$が$1_A$で取る値$\eta(A)(1_A)\in F(A)$によって一意に指定され，また逆に$F(A)$で取る値によってその自然変換を復元できる．
これは今までの章で定義してきた圏論の様々の概念が，絶妙な条件の強弱で定義されているという結果を物語っているのかもしれない．

だから，前層の圏（の射）を調べるときは，表現可能関手を媒介にすれば良い，という方針が立つ．その良い例が\ref{section-vectorspace-base}節での議論である．圏$\mathbf{FinVect}_\mathbb{R}$では$h^{\mathbb{R}^n}$という表現可能関手があり，線型空間とベクトルの空間を繋ぐ役割をする関手$G$がどの$h^{\mathbb{R}^n}$と同型になるかは$n\in\mathbb{N}$に依り，これを線型空間の次元という．

系\ref{Yoneda's-lemma-1}は，米田の補題が描写する$C'$上の射の様子のうち，特に反変Hom関手同士の間の射についての部分の主張を取り上げている．この場合は，圏$C$の２元$A,B$の間の射$f:A\to B$が，その２つが表現する反変Hom関手（前層）$h_A,h_B$の間の自然変換に一対一対応しているという様子を描写している．

圏$C$からその上の前層の圏への関手である「米田の埋め込み」の視点からは次の命題が成り立ち，「圏$C$の対象$A$を知ることは，圏$[C^{op},\mathbf{Set}]$の対象である$h_A$，即ち，他の対象から入ってくる射の集合を知ることと同等であることがわかる．\footnote{the probes of $X$ by $A$ are indeed the maps of generalized objects from $A$ into $X$}
そして，前層の圏は，米田の埋め込みの値である反変Hom関手，つまり表現可能前層を拠点として調べることができる．
\begin{corollary}[米田の補題の系２：Yoneda embedding]\rm{}\label{Yoneda's-lemma-2}
    $C$を圏とする．このとき，その前層の圏$C'=[C^{op},\mathbf{Set}]$との間に，次のような充満忠実関手$y:C\to C'$が存在する．（これを\textbf{米田の埋め込み(Yoneda embedding)}という）．
    \begin{center}\begin{tikzcd}
        C \ar[r, "y"] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & {[C^{op},\mathbf{Set}]} \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        A \ar[r, mapsto] & h_A=\mathrm{Hom}_C(-,A) \\
        f:A\to B \ar[r, mapsto] & \varphi_f=f_*:h_A\to h_B
    \end{tikzcd}\end{center}
\end{corollary}
\begin{proof}\rm{}
    この関手$y$の射写像は，任意の$A,B\in C$についてのHom集合$\mathrm{Hom}_C(A,B)$毎に，系\ref{Yoneda's-lemma-1}での写像$\varphi$に他ならない．系\ref{Yoneda's-lemma-1}によりこれは可逆だから，関手$y$は充満忠実である．
\end{proof}


\begin{corollary}[米田の補題の系３：uniqueness of representing objects]\label{Yoneda's-lemma-3}
    ある前層$F:C^{op}\to\mathbf{Set}$について，それを表現する元$A\in C$とは，同型$\hom_C(-,A)\simeq F$が存在するような$A\in C$のことであるが，これは存在するなら同型の差を除いて一意である．
\end{corollary}
\begin{proof}
    $A,B$はともに$F$を表現するとする．このとき，$h_A,h_B$の間に同型が存在することになる．系\ref{Yoneda's-lemma-2}より，$A,B\in C$は同型である．\footnote{圏論的には意味を持たない事実であるが，これは関手$y$が充満忠実でなくとも，射写像が全単射なら十分に成り立つ．}
\end{proof}

\section{種々の特別な対象}

\subsection{始対象／終対象を持つ圏}

\begin{proposition}[始対象を持つ圏の特徴付け]\rm{}
    圏$C$について，以下の２条件は同値．
    
    1.\, 圏$C$は始対象を持つ．

    2.\, 関手$C\to 1$は右随伴(right adjoint)を持つ．
\end{proposition}
この下で，圏$C$の始対象は，終圏(terminal object)$1$の唯一の対象$0$の，右随伴による像である．

\section{直積}

\subsection{デカルト圏}

\chapter{随伴(adjoint)}
圏の同値は，対象の集合に関して，圏の同型から弱めた概念であった．随伴関手は，圏の同値をさらに弱めた概念である．
次が成り立つ．
\begin{proposition}
    $F:C\to D, G:D\to C$を関手とする．次の３つの条件は同値である．\rm{}

    1.\, $F$と$G$は圏の同値である．

    2.\, $F$は$G$の左随伴関手であり，かつ，２つの関手は充満忠実である．
\end{proposition}

\section{随伴の定義}
随伴には同値な定義が最低でも３つある．なお，関連する用語も，adjunction, adjoint, adjunctの３つがある．

\begin{definition}[Hom集合随伴としての定義]\rm{}
    ２つの圏$C,D$の間のHom集合の随伴とは，２つの関手$F:C\leftarrow D, G:C\rightarrow D$と，双関手$D\times C\to\mathbf{Set}$の間の自然同型$\Phi :\hom_C(F-,-)\to\hom_C(-,G-)$の3-組$(F,G,\Phi)$のことである．
    この関係を$(\Phi :)F\rotatebox{180}{$\vdash$}G$と書き，\textbf{$F$は$G$の左随伴(left adjoint)であり，$G$は$F$の右随伴(right adjoint)である}という．
    このHom集合間の同型(bijection)を\textbf{adjunction}という．また，$X\in C, Y\in D$として$f\in\hom_C(FY,X)$に対して，$D$の射$\Phi (f)$を\textbf{右随伴(right adjunct)}という．
\end{definition}

\begin{definition}[普遍射を用いた定義]
    
\end{definition}
これは書くのが簡単で，証明する場合には一番使いやすい定義となる．また，最適化への応用へも一番近い．

\begin{definition}[余単位-単位随伴による定義]
    
\end{definition}

\chapter{圏の構成(constructions on categories)}

\section{具体圏(concrete category)}

\subsection{具体圏の定義}
\begin{shadebox}\begin{definition}[具体圏]\rm{}
    $(C,M,s,t,c,e)$を圏とする．忠実な関手$F:C\rightarrow \mathbf{Set}$が存在するときに，組$(C,F)$のことを「具体圏」と呼ぶ．また，このような忠実関手$F$が存在する圏$C$のことを「具体化可能(concretizable)」という．
\end{definition}\end{shadebox}
定義内の関手$F$の例として，例えば忘却関手がある．忘却関手は，圏$C$の対象をその台集合に写し，射はその台写像(underlying mapping)に写す．集合論が構築する様々な対象のうち，「集合の上に，付加構造を追加する」という形で定式化される構造が圏をなすとき，それは具体圏をなすという言葉で捉えられる．
関手$F$の取り方はいく通りも存在する場合が殆どだが，上述した忘却関手のような一番自然なものを取ることが多い．

\subsubsection{具体圏の例：\textbf{Top, Grp}}

\part{圏論の拡張}

\chapter{豊穣圏(enriched category)}
圏の定義の，集合論からの遊離とも捉えられる．射集合がベクトル空間や位相空間としてなどの追加の構造を備えている場合，即ち，射の集合としてホム集合と呼んでいた物が，特別\textbf{Set}のではなく一般のモノイド圏の対象となるようなものでも良いとする拡張である．
すると，今まで考えていた圏は，集合の直積をモノイド積として備えた集合の圏$(\mathbf{Set},\times,\{\cdot\} )$で豊穣化された圏のことであると相対化される．

\section{豊穣圏の定義}
\begin{definition}\rm{}
    $K$をモノイド圏とする．圏$C$のホム集合が圏$K$の対象となるとき$\mathrm{Hom}_C(A,B)\in K$（これをホム対象(hom-objects)という），
    この圏$C$を\textbf{$K$-圏(K-category)}，または\textbf{$K$-豊穣圏(category enriched over/in K)}という．
\end{definition}

\chapter{2-圏}
圏の圏\textbf{Cat}についての考察を通じて，圏自体の定義を拡張し，今までの圏の定義\ref{def-category}を1-圏として相対化する枠組みを提供する．

\section{2-圏の定義}
2-圏の定義は２つあり，2-morphismの合成についての条件が違う．
strick 2-categoryとは，デカルトモノイド圏$\mathbf{Cat}$上の豊穣圏のことである．
weak 2-categoryは，2-morphismの合成則を，同型の違いの範囲で許容する(weakly enriched over \textbf{Cat})．
\begin{definition}[strict 2-category]\rm{}
    圏$C$のホム集合$\mathrm{Hom}_C(A,B)$のそれぞれ自身が圏と見做せる（これをホム圏(hom-categories)という）とき，これを2-圏と呼ぶ．
    このとき，ホム圏間の射（即ち関手）を2-射(2-morphism)といい，元々の意味での$C$の射を1-射(1-morphism)という．
\end{definition}

\begin{definition}[weak/general 2-category / bicategory]
    
\end{definition}

\section{2-圏の例}

前順序集合の圏\textbf{Ord}は２つの意味で2-圏である．
まず，これが圏$2$（対象の集合を$2$とし，射の集合は$0\to 1$のみを元とする一点集合，モノイド積は連言，モノイド単位は$1$）上での豊穣圏であるから．
あるいは，\textbf{Ord}の射は，点ごとの関係$f\le g:\Longleftrightarrow \forall (f(x)\le g(x))$によって前順序集合をなすから，この意味で任意の$n$-圏と見做せるのではないか？
次に，\textbf{Ord}の対象の１つ１つが圏とみなせ，2-射はその関手の間の射となる．

\chapter{閉圏(closed category)}
閉圏とは，圏の上にclosed structureと呼ばれる，内部Hom関手の構造が存在するような圏のことである．
その構造とは，圏$C$の対象$X,Y$について，射の集合自体も圏$C$の対象$\hom(X,Y)\in C$と見做せることであり，この対象を\textbf{内部Hom（対象）(internal hom (object))}と呼ぶ．これを$[X,Y]$ともかく．
つまり，自身の豊穣圏と見做せるような圏であり，即ち内部Homとは，Hom対象の特別な，内部である（同じ圏の中で見つかる）場合である．１つの圏の中で話が済む，という意味でのclosedであろう．
例えば\textbf{Set}はそうである．
なお，閉圏の上の忘却関手$U:C\to\mathbf{Set}$は，内部Hom関手を外部Hom関手に写す．\footnote{Hom関手のwikipedia page}

内部Hom関手は内部積関手の随伴関手である．
簡単な例に引き寄せて言えば，集合$X$との直積を取る行為は，定義域を$X$とする関数全体の集合を定めることの，左随伴(left adjoint)である．
これは，\textbf{Set}に直積をモノイド積と見なしたものが，デカルト閉圏をなす，と表現される．

\section{閉圏の定義}

\begin{definition}[closed category]\label{def-closed-category} \rm{}
    圏$C$に対して，6-組$(C,[-,-],I,i,j_X,L^X_{YZ})$が以下の条件を充たすとき，これを閉圏という．ただし，$[-,-]:C^{op}\times C\to C$は\textbf{内部Hom関手(internal hom-functor)}と呼ばれる関手（$[-,-]$の代わりに，関手性を強調して$\Rightarrow$と書かれることや，$\hom (-,-)$と書かれることもある），
    $I\in C$は単位対象(unit object)と呼ばれる対象，$i:id_C\simeq [I,-]$は関手の同型，$j_X:I\to [X,X]$は
\end{definition}

\section{デカルト閉圏(cartesian closed category)}

モノイド積が通常の積である時のモノイド閉圏をデカルト閉圏という．この時の内部Homを，冪対象と呼ぶ．
即ち，圏$C$が，直積を取るという内部Hom関手が定義できており，
デカルト閉圏では，内部Hom対象$[X,Y]$を$X^Y$とも書き，これを特に指数対象／冪対象(exponential object)と呼ぶ．
\subsection{デカルト閉圏の例}

\textbf{Set}に集合の直積をモノイド積としたものはデカルト閉圏であるが，この圏での指数対象は配置集合(function set)となる．

\textbf{Cat}に圏の積をモノイド積としたものもデカルト閉圏になる．この圏での冪対象は関手の圏$[C,D]$または$D^C$である．

\begin{definition}[exponential object]\rm{}
    圏$C$上に，積と呼ばれる双関手$C\times C\to C$が定義されているとする．
    このとき，$X, Y\in C$の冪対象とは，任意の対象$Z\in C$と射$e:Z\times Y\to X$と射$\mathrm{ev}:X^Y\times Y\to X$について，
    次の図式を可換にするような射$u:Z\to X^Y$が存在するような対象$X^Y$のことである．
    \begin{center}\begin{tikzcd}
        Z\times Y \ar[r, "u\times 1_Y"] \ar[dr, "e"] & X^Y\times Y \ar[d, "\mathrm{ev}"] \\
        & X
    \end{tikzcd}\end{center}
    この射$u$を\textbf{exponential transpose}や$e$の\textbf{カリー化(currying)}などという．また，ラムダ計算では$\lambda(e)$や$e^\flat$などと書かれることもある．
\end{definition}
冪対象$X^Y$が圏$C$内に存在する時，これを\textbf{$X$は$Y$を冪化する(X exponentiates Y)}という．
対象$Y$が，全ての$X$に対して冪対象$X^Y$を圏の内部に持つ時，この対象$Y$のことを\textbf{冪化可能(exponentiable / powerful)}という．

\begin{definition}[cartesian closed]\rm{}
    圏$C$が終対象をもち，全ての対象が冪化可能(exponentiable)である時，この圏をデカルト閉圏(ccc)であるという．
\end{definition}

\chapter{モノイド圏(Monoidal category)}
モノイド圏とは，圏の上に，monoidal structureと呼ばれる付加的な構造が存在するような圏のことである．
モノイド閉圏においては，内部Hom関手は内部積関手の随伴関手である．
元々は，こちらの流儀で，その名残がGray tensor productとAbelian groupsの例に残っている．\footnote{nLabのclosed+categoryのエントリ}

\section{モノイド圏の定義}
\begin{definition}[Monoidal category / tensor category]\rm{}
    モノイド圏とは，次の条件を充たす6-組$(\mathbf{C},\otimes,I,\alpha,\lambda,\rho)$である．ただし，$\mathbf{C}$は圏，$\otimes:\mathbf{C}\times \mathbf{C}\to \mathbf{C}$は\textbf{テンソル積}または\textbf{モノイド積}と呼ばれる双関手（\textbf{内部積関手(internal product functor)}とも呼ぶ），$I\in \mathbf{C}$は\textbf{モノイド単位}または\textbf{単位対象}と呼ばれる圏$\mathbf{C}$の対象であり，$\alpha,\lambda,\rho$は関手の同型である．

    1.\, ［緩められた結合律］２つの関手$(-\otimes -)\otimes -,-\otimes (-\otimes -):\mathbf{C}\times \mathbf{C}\times \mathbf{C}\to \mathbf{C}$の間に\textbf{結合子(associator)}と呼ばれる関手の同型$\alpha$が存在する．
    即ち，各対象$A,B,C\in\mathbf{C}$に対する成分が，$\mathbf{C}$上の同型$$\alpha_{A,B,C}:(A\otimes B)\otimes C\simeq A\otimes (B\otimes C)$$である．

    2.\, ［緩められた単位律］２つの関手$I\otimes -$と$1_C$の間に，夫々\textbf{左単位子，右単位子(unitor)}と呼ばれる互いに逆向きの関手の同型$\lambda,\rho$が存在する．
    即ち，各対象$A\in\mathbf{C}$に対して，$\lambda,\rho$成分は夫々$$\lambda_A:I\otimes A\simeq A,\hspace{3mm}\rho_A:A\otimes I\simeq A$$である．

    3.\, ［整合性条件(coherence condition)］これら３つの関手の同型$\alpha,\lambda,\rho$について，次の図式\ref{def-monoidal-1},\ref{def-monoidal-2}は任意の対象$A,B,C,D\in\mathbf{C}$について可換である．
    また，３つの関手の射$\alpha,\lambda,\rho$が恒等射であった場合（即ち，結合律と単位律が同型ではなく，相等関係として成立する場合），この6-組を特に\textbf{強モノイド圏(strict monoidal category)}という．
\end{definition}
\begin{figure}[h]\begin{center}\caption{これはなんだ．pentagon identityと呼ばれる４項の間の結合性についての条件で，これが成り立てば任意の$n\in\mathbb{N}$について整合的な結合性が成り立つ．\label{def-monoidal-1}}
    \begin{tikzcd}
        ((A\otimes B)\otimes C)\otimes D \ar[r, "{\alpha_{A,B,C}\otimes 1_D}"] \ar[d, "{\alpha_{A\otimes B,C,D}}"] & (A\otimes (B\otimes C))\otimes D \ar[r, "{\alpha_{A,B\otimes C,D}}"] & A\otimes ((B\otimes C)\otimes D) \ar[d, "{1_A\otimes\alpha_{B,C,D}}"] \\
        ((A\otimes B)\otimes (C\otimes D) \ar[rr, "{\alpha_{A,B,C\otimes D}}"] & & A\otimes (B\otimes (C\otimes D))
    \end{tikzcd}
\end{center}\end{figure}
\begin{figure}[h]\begin{center}\caption{何もわからん．triangle identiryと呼ばれる．\label{def-monoidal-2}}
    \begin{tikzcd}
        (A\otimes I)\otimes B \ar[dr, "{\rho_A\otimes 1_B}"] \ar[rr, "{\alpha_{A,I,B}}"] & & A\otimes (I\otimes B) \ar[dl, "{1_A\otimes\lambda_B}"] \\
        & A\otimes B &
    \end{tikzcd}
\end{center}\end{figure}

なぜ，整合性条件の必要性が発生するのだろうか．

\section{モノイド圏の例}

\subsection{デカルトモノイド圏}
直積の概念は，モノイド積／テンソル積の良い雛型であるようだ．
一般に，有限積を持つデカルト圏は，いずれも積をモノイド積，終対象を単位対象として，モノイド圏を成す．これを\textbf{デカルトモノイド圏(cartesian (monoidal) category)}という．

集合の圏\textbf{Set}は直積をモノイド積，一元集合を単位対象とすると，モノイド圏をなす．

圏の圏\textbf{Cat}は，圏の直積をモノイド積，単対象離散圏を単位対象とするモノイド圏を成す．

\section{モノイド同値}

\section{閉モノイド圏(closed monoidal category)}
\begin{definition}[closed monoidal category]\rm{}
    モノイド圏$C$が，閉モノイド圏であるとは，$X\in C$を任意の対象として，対象$X$とのテンソル積を取る関手$-\otimes X:C\to C$が，$X$との内部Hom集合を取る関手$[X,-]:C\to C$を右随伴として持つこと，
    即ち次の全単射(adjunction)$\Phi$が各$A,B\in C$について存在することを言う．
    $$\Phi_{A,B}:\mathrm{Hom}_C(A\otimes X,B)\simeq \mathrm{Hom}_C(A,X\Rightarrow C) = \mathrm{Hom}_C(A,[X,C])$$
    なお，これを\textbf{カリー化(currying)}という．
\end{definition}

\begin{proposition}
    任意のモノイド圏は，或る強モノイド圏とモノイド同値である．
\end{proposition}
これは圏論の結果から自然に類推される．

\part{層(sheaf)}

\chapter{Introduction}

幾何学とは形を捉える数学の三大分野の一つである．例をあげよう．
\begin{eqnarray*}球面S^2 &:=& \{ (x,y,z) \in \mathbb{R}^3 \mid x^2+y^2+z^2 = 1 \} \\ トーラスT^2 &:=& \{ (x,y,z)\in\mathbb{R}^3 \mid (\sqrt{x^2+y^2}-2)^2 + z^2 = 1 \}\end{eqnarray*}
とすると，$S^2$と$T^2$は位相空間としては同相ではない．これを「大域的に違う」と表現する．しかし，$S^2$も$T^2$も，その曲面の一部を取り出すと似ている．これを「局所的には同じ」と表現する．\\
この大域と局所のズレを捉える，非常に自然な物の見方が「層(sheaf)」である．

\section{これが圏論の上で行われる理由}

集合は，１つ１つバラバラな元の集まりを，ひとつの全体として捉える．
しかし，この２元的な見方のいずれかの極しかないとなると，その間の微妙な関係が見えてこない．
ということで，全体と個別の間に中間的なものを設定する，という発想が開集合系とそれによる位相空間の定義であり，これが幾何学の基礎となっていた．


連続写像と，以下の２つの性質を持つ．
\begin{itembox}[l]{連続写像の性質}
    １：全体上で定義された連続写像は，定義域を狭めて制限しても連続写像である．\\
    ２：局所的に定義された連続写像は，その定義域を全体に拡張しても連続写像になる．
\end{itembox}

\chapter{位相空間と連続写像}
すでに慣れているEuclid空間での議論を経て，位相空間と連続写像の概念を，集合論的観点から要素を抽出して定義し直すやり方は，圏論的に「圏と射」の関係として見直せることを説明する．

\section{Euclid空間での開集合の定義から，特徴づけを導く}

\begin{shadebox}\begin{definition}[Euclid空間上の開集合の，$\epsilon -\delta$論法による定義]
    平面$\mathbb{R}^2$の部分集合$U$が開集合であるとは，$U$内の任意の点$(s,t)$に対し，実数$r>0$であって，$U_r(s,t)\subset U$となるものが存在するということ．\\
    但し，$U_r := \{ (x,y)\in\mathbb{R}^2 | (x-s)^2 + (y-t)^2 < r^2 \}$とする．
\end{definition}\end{shadebox}

\begin{shadebox}\begin{definition}[連続写像の，$\epsilon -\delta$論法による定義]
    $U,V$を平面$\mathbb{R}^2$の開部分集合とする．$f:U\rightarrow V$が連続写像であるとは，$U$の任意の点$(s,t)$と任意の実数$q>0$に対して，実数$r>0$であって，$$U_r(s,t)\subset U \wedge f(U_r(s,t))\subset U_q(f(s,t))$$となるようなものが存在することである．
\end{definition}\end{shadebox}

以上見て来たEuclid空間上での$\epsilon -\delta$論法による定義は，距離の概念を使用して，些か直感的に定義している．例えば$$d((x,y),(s,t)):=\sqrt{(x-s)^2+(y-t)^2}$$と置くと，$f$が連続写像であるとは，$$d((x,y),(s,t))<r\rightarrow d(f(x,y),f(s,t))<q$$を充たすことである．これは「$V$で近い点は$U$でもどこまでも近い」という感覚に非常に合致した定義だと言えよう．\par
しかし，このように距離の言葉に翻訳しなくても連続の概念は定義出来る，というのがミソなのであった．

\begin{shadebox}\begin{definition}[連続写像の特徴付け]
    $U,V\subset\mathbb{R}^2$を開集合とする．写像$f:U\rightarrow V$に対して，次の条件(1),(2)は同値である．\\
    (1) $f$は連続である．\\
    (2) $V$に含まれる$\mathbb{R}^2$の任意の開集合$W$に対して，その$f$による逆像$f^{-1}(W)$は$U$に含まれる$\mathbb{R}^2$の開集合である．
\end{definition}\end{shadebox}

\begin{proof}
    \underline{(1)$\rightarrow$(2)}\\
    $W\subset V$を$\mathbb{R}^2$の開集合とする．$U$上の点$(s,t)\in f^{-1}(W)$を任意に取る．すると，定義上，$f(s,t)\in W\subset V$となる．従って点$f(s,t)$は開集合$W$内部の点だから，実数$q>0$が存在して，$U_q(f(s,t))\subset W$を充たす．続いて$f$は連続なので，$f(U_r(s,t))\subset U_q(f(s,t))(\subset W)$となる実数$r>0$が存在する．従って，\underline{写像は包含関係を保存する射だから，}$U_r(s,t)\subset f^{-1}(W)$を得る．点$(s,t)$は任意に取ったから，逆像$f^{-1}(W)$は$\mathbb{R}^2$上の開集合である．\\
    \underline{(2)$\rightarrow$(1)}\\
    $U$内の任意の点$(s,t)$と実数$q>0$を任意に取る．$V$は開集合で，$f(s,t)\in V$だから，$q'>0$であって$U_{q'}(f(s,t))\subset V$となるような実数が存在する．$q'>q$だったならば$q'=q$と置き換えることにより，一般に$q'\le q$として良い．$W$を$U_{q'}(f(s,t))$として(2)を適用すると，この逆像$f^{-1}(U_{q'}f(s,t))$は開集合になる．$q>0$だから勿論$(s,t)\in f^{-1}(U_{q'}f(s,t))$であるから，実数$r>0$であって$U_r(s,t)\subset f^{-1}(U_{q'}f(s,t)) \subset f^{-1}(U_{q}f(s,t)) (\because q'\le q)$となるものが存在する．よって，$f(U_r(s,t))\subset U_q(f(s,t))$を得る．従って$f$は連続写像．
\end{proof}

\begin{shadebox}\begin{proposition}[Euclid空間の開集合の集合演算に対する性質]\label{proposition1}
    1, $(U_i)_{i\in I}$を$\mathbb{R}^2$の開集合の族とすると，合併$\bigcup_{i\in I}U_i$も開集合となる．\\
    2, $(U_i)_{i\in I}$を$\mathbb{R}^2$の開集合の有限族とすると，共通部分$\bigcap_{i\in I}U_i$も開集合となる．\\
\end{proposition}\end{shadebox}

但し，合併とは$\bigcup_{i\in I}U_i := \{ (x,y)\in\mathbb{R}^2 | \exists i\in I \rm{s.t.} (x,y)\in U_i \}$を意味し，共通部分とは$\bigcap_{i\in I}U_i := \{ (x,y)\in\mathbb{R}^2 | \forall i\in I [\underline{i\in I \rightarrow} (x,y)\in U_i ]\}$を意味する．\\
こう見ると，合併と共通部分は，$\forall と \exists$との双対に基づいた，明らかな双対概念だなぁ．\\
$I$が２元集合，例えば$I={1,2}$の時，$U_1 \cup U_2$や$U_1 \cap U_2$などと，中置記法で書く．$I=\varnothing$の時，$\bigcup_{i\in\varnothing}U_i = \varnothing$とする（零和）．一方零積は，下線部の前提条件が常に偽だから，$\bigcap_{i\in\varnothing}U_i = \mathbb{R}^2$（普遍集合）と約束する．\\

\begin{proof}

\end{proof}

\section{位相空間を，特徴付けだった方を公理として定義する}

これらを用いて，次のように位相空間を定義する．

\begin{shadebox}\begin{definition}[位相空間]
    $X$を集合とする．$X$の冪集合$\mathcal{P}$の部分集合$O$が次の条件(1),(2)を充たす時，$O$は$X$の位相であるという．\\
    (1) $(U_i)_{i\in I}$が$O$に属する$X$の部分集合の族ならば，合併$\bigcup_{i\in I}U_i$も$O$の元である．なお特に，$\bigcup_{i\in\varnothing}U_i=\varnothing\in O$である．\\
    (2) $(U_i)_{i\in I}$が$O$に属する$X$の部分集合の有限族ならば，共通部分$\bigcap_{i\in I}U_i$も$O$の元である．なお特に，$\bigcap_{i\in\varnothing}U_i=X\in O$である\\
    集合$X$に対$(X,O)$が指定されている時，この$X$を位相空間と呼び，この$O$を$X$の開集合系，$O$の元を$X$の開集合という．
\end{definition}\end{shadebox}

\subsection{例１：Euclid空間}
$X=\mathbb{R}^2, O=\{ U\in \mathcal{P}(\mathbb{R}^2) | Uは\mathbb{R}^2の開集合である． \}$と定めると，$O$は$\mathbb{R}^2$の位相となっている．$\because 命題\ref{proposition1}$

\subsection{例２：離散（位相）空間}
集合$X$に対して，$\mathcal{P}(X)$は位相になる．こうして生成した位相空間を離散位相空間という．

\subsection{例３：２元集合の位相}
$\mathbb{S}=\{ 0,1\}$とする（一次元球面）．$O=\{\emptyset, \mathbb{S}, \{1\}\} = \mathcal{P}(\mathbb{S})-\{ 0 \}$は$\mathbb{S}$の位相となる．

\section{部分位相空間}
$X$を位相空間とし，$O$をその位相とする．$X$の部分集合$A$に対して，位相$O$の各元の$A$との共通部分を取ったものからなる集合$O_A:=\{ U\cap A | U\in O \}$は$A$の位相になる．
\begin{eqnarray*}
    \bigcup_{i\in I}(U_i\cap A) &=& (\bigcup_{i\in I} \cap A) \\
    \bigcap_{i\in I}(U_i\cap A) &=& (\bigcap_{i\in I}) \cap A 
\end{eqnarray*}
より，確かに２つの公理を充たす．この位相$O_A$によって部分集合$A$を位相空間とみなした場合，これを部分位相空間という．\par

$A$が$X$の開集合だった場合，即ち，$A\in O$であった場合，$O_A=\{U\in O | U\subset A \}$でもある．つまり，「$A$の部分集合である$X$の開集合」と「$A$を$X$の部分位相空間と考えた時の開集合」とは常に一致する．\\
$\supset$は$U$を$A$の部分集合かつ$O$の元とすれば，$U\cap A=U$なので，確かに$U\in O_A$．一方$\subset$は，$U\in O_A$とすると，$A$は開集合だから，命題\ref{proposition1}(2)より開集合同士の合併は開集合で，$U\cap A \in O$．なお，$U\in O_A$としたから明らかに$U\subset A$．

例：$S^2やT^2$は$\mathbb{R}^3$の部分位相空間である．\\

\section{連続写像}

\begin{shadebox}\begin{definition}[連続写像]
    $X,Y$を位相空間とし，$O_X,O_Y$を其々の位相とする．写像$f:X\rightarrow Y$が連続写像であるとは，$V\subset Y$が$Y$の開集合ならば，その逆像$f^{-1}(V)(\subset X)$が$X$の開集合であることを言う．
\end{definition}\end{shadebox}
特に$X,Y$が$\mathbb{R}^2$の開集合であった場合，これは命題\ref{proposition1}と合致する．



\end{document}