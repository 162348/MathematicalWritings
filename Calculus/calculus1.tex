\documentclass[uplatex, dvipdfmx]{jsreport}
\title{微分積分学 石毛和弘\thanks{メールアドレスはishige@ms.u-tokyo.ac.jp} \\ 講義ノート}
\author{Hirofumi Shiba\thanks{hirofumi-shiba48@g.ecc.u-tokyo.ac.jp}}
\date{\today}
\pagestyle{headings} \setcounter{secnumdepth}{4}
\input{/Users/hirofumi.shiba48/Desktop/数理科学/preamble.tex}
\begin{document}
\tableofcontents

微分積分学②では，まず（２変数の）偏微分とその応用を復習してから，１変数関数の積分，次に多変数関数の積分へと進む．
Jacobianの計算などが，後期試験の花形になるであろう．最後に級数に触れて，微分積分学②の講義は締めくくられる．絶対収束という概念を導入して，より詳しく収束を議論する．

微分積分学の講義では，一変数の場合から二変数の場合に微分と積分の理論を拡張して，最後に無限級数の話をして終わった．
微分積分学続論では，一般の$n$変数関数$\mathbb{R}^n\supset U\to\mathbb{R}^m$の場合についての理論を，線形代数学の言葉をしっかり用いて厳密に組み立てる．

\chapter*{記法の整理}
$\mathbb{R}$を実数全体の集合とし，$\mathbb{R}^n=\left\{\left(\begin{array}{c}
    x_1 \\ \vdots \\ x_n
\end{array}\right)\in\mathbb{R}^n\;\middle| \;x_1,\cdots,x_n\in\mathbb{R} \right\}$を，縦ベクトルの集合とする．
こうすると，今までの記法に，行列積を考慮に入れれば，例えば$f(x)=ax+b$に対して$f'(x)=a$という式変形が，一般の$f:\mathbb{R}^n\to\mathbb{R}^m$の場合にも整合的に成り立つからである．

実数値関数の導値は横ベクトルであり，$\mathbb{R}$の部分集合上に定義域を持つ関数の導値は縦ベクトルである．

$f:\mathbb{R}^n\ni\mapsto f\left(\begin{array}{c}
    x_1 \\ \vdots \\ x_n
\end{array}\right)\mathbb{R}$をn変数実数値関数といい，これをm個組にして扱う時$f:\mathbb{R}^n\to\mathbb{R}^m$と書く．

\part{微分}
\chapter{極値判定法}
Euclid空間を所与のものとして理論の展開を始める．

\section{微分の定義}
以下，n変数実数値関数$f:\mathbb{R}^n\to\mathbb{R}$について微分の定義を考える．
微分可能とは，一変数関数の場合は，関数の増分$\Delta f=f(x+h)-f(x)$が，同次一次式$f'(x)h$に，それより高次の無限小を除いて近似されることであり，その係数$f'(x)\in\mathbb{R}$を導値と言った．
n変数ベクトル値関数$f:\mathbb{R}^n\to\mathbb{R}^m$の場合についても，関数の変位$\Delta f=f(x+h)-f(x)$が，線型写像$f_A$による$h$の値を取ることを表す同次一次関数$Ah$で，高次の無限小を除いて近似されることである．
この時の$(m,n)$-行列$A$が同値$f'(x)$となる．この$i,j$-成分は，基底方向についての偏導関数$\frac{\partial f_i}{\partial x_j}$として得られる．

代数的な式と，抽象的な，あるいは幾何学的な意味での線型写像とを結びつけるものとして，行列の理論を多用することになる．

\begin{definition}[収束]
    \[\lim_{x\to a}f(x)=\alpha :\Leftrightarrow \forall\varepsilon >0\;\exists\delta >0\; 0<||x-a||<\delta\Rightarrow |f(x)-\alpha |<\varepsilon\]
\end{definition}

\begin{definition}[偏微分]
    \[ \frac{\partial f}{\partial x_i} \left(\begin{array}{c}a_1 \\ \vdots \\ a_n\end{array}\right):=\lim_{h\to 0}\frac{1}{h}\left( f\frac{\partial f}{\partial x_i} \left(\begin{array}{c}a_1 \\ \vdots \\a_i+h\\ \vdots \\ x_n\end{array}\right)-f\frac{\partial f}{\partial x_i} \left(\begin{array}{c}a_1 \\ \vdots \\ a_i \\ \vdots \\ a_n\end{array}\right) \right) \]
    によって定めた対応$\mathbb{R}^n\ni\left(\begin{array}{c}a_1 \\ \vdots \\ a_n\end{array}\right)\mapsto \frac{\partial f}{\partial x_i}\left(\begin{array}{c}x_1 \\ \vdots \\ x_n\end{array}\right)\in\mathbb{R}$
    を偏導関数という．
\end{definition}

\begin{definition}[（全）微分可能性]
    $f(x)$は$x=a$で微分可能であるとは，次の同値な条件を満たすこと．

    1. \[ \exists d_1,\cdots,d_n\in\mathbb{R}\; \lim_{x\to a}\frac{f(x)-f(a)-(d_1(x_1-a_1)+\cdots+d_n(x_n-a_n))}{||x-a||} = 0 \]
    2. \begin{eqnarray*} \exists d=(d_1,\cdots,d_n)\in\mathbb{R}^n\; f(x)-f(a) &=& d(x-a) + o(||x-a||)\;\;\; (x\to a) \\
        &=& (d_1\cdots d_n)\left(\begin{array}{c}x_1-a_1 \\ \vdots \\ x_n-a_n\end{array}\right) + o(||x-a||)\;\;\; (x\to a)  \end{eqnarray*}
\end{definition}
これは案に「全ての近づき方」を想定している強力な主張である．従って，微分可能であるとき，特に固定されたn方向についても微分可能だから，$d_i=\frac{\partial f}{\partial x_i}(a)$が成り立つ．
（一方，逆は必ずしも成り立たない．）
従って，これを満たす「接超平面」は存在するなら唯一つである．

\section{Chain Rule}

\begin{theorem}[Chain Rule]
    $f:\mathbb{R}^n\to\mathbb{R}, \varphi:\mathbb{R}^m\ni y\mapsto \varphi(y)\in\mathbb{R}^n$はいずれも微分可能とする．$f\circ \varphi$を$y$で偏微分することを考えたい．
    各$b\in\mathbb{R}^m$に対して
    \[ \frac{\partial (f\circ\varphi)}{\partial y_i} (b) = \sum_{k=1}^n\frac{\partial \varphi_k}{\partial y_i}(b)\frac{\partial f}{\partial x_k}(\varphi(b)) \]
    となる．
\end{theorem}

\begin{theorem}\label{thm-exchange-of-partial-derivative}
    $f:U\to\mathbb{R}^n$が$C^k$級ならば，$f$の$k$階までの偏導関数は偏微分の順序によらない．
\end{theorem}

以降，関数といえば，$C^\infty$級を暗に仮定する．また，引き続き$\mathbb{R}^n$全域で定義されていることを暗に約束する．開集合について必要な理論を付け足せば，局所的な理論を得る．

\section{Taylorの定理}

まず，多変数実数値関数の定義域内に直線を引いて，それのパラメータとの合成関数を考える．
これは，多変数のTaylorの定理を示すのに用いる道具であると同時に，各方向についての微分を考える場面で，基本的な道具になる．
$\mathbb{R}^n$内の点$x$の（実際は直線$L$上の点なら何処でも良い），ベクトル$z$方向の導値（方向微分）を求める時など．この命題において，$\varphi'(t)=(D_z\varphi)(t)$である．
\begin{proposition}
    $f:\mathbb{R}^n\supset U\to\mathbb{R}$を$C^k$級関数とする．$x,z\in U\subset\mathbb{R}^n$を取り，直線$L:=\{g(t)=x+tz\mid t\in [0,1]\}$と定める．
    この時，$\varphi=f\circ g:[0,1]\to\mathbb{R}$次が成り立つ．
    
    1. $\varphi$は$C^k$級関数である．

    2. 次が成り立つ．
    \[ \varphi^{(m)}(t) = \sum_{1\le i_1,\cdots,i_m\le n}\frac{\partial^m f}{\partial x_{i_1}\cdots\partial x_{i_m}}(g(t))\cdot z_{i_1}\cdots z_{i_m} \]

\end{proposition}
\begin{proof}　

    1. $\varepsilon>0$が存在して，$g$従って$\varphi$の定義域は$[-\varepsilon,1+\varepsilon]$に拡張できる．

    2. 従って，Chain Ruleより，次が成り立つ．
    \begin{eqnarray*} \varphi'(t) &=& \frac{\partial f}{\partial x}\frac{d g}{dt} \\
        &=& (\frac{\partial f}{\partial x_1} \cdots \frac{\partial f}{\partial x_n})\left(\begin{array}{c}z_1 \\ \vdots \\ z_n\end{array}\right) \\
        &=& \sum_{1\le i\le m} \frac{\partial f}{\partial x_i}(g(t))\cdot z_i
    \end{eqnarray*}
    
    3. $m<k$について成り立つと仮定して，$m+1\le k$について導く．定理\ref{thm-exchange-of-partial-derivative}より．
\end{proof}

関数の（全）微分(differential)の概念を導入して，表記を簡略化することを考える．
\begin{definition}[関数のm次微分(m-th differential)]
    この式の右辺は$z_1,\cdots,z_n$についてのm次同次多項式（m形式）となっている．
    一般に，多変数実数値関数$f:\mathbb{R}^n\supset U\to\mathbb{R}$に対して，各点$x\in U$に対して，
    \[ (d^mf)_p(z):=\sum_{1\le i_1,\cdots,i_m\le n}\frac{\partial^m f}{\partial x_{i_1}\cdots\partial x_{i_m}}(x)\cdot z_{i_1}\cdots z_{i_m} \]
    を点$p$に於ける$f$のm-次微分という．
\end{definition}
生えているベクトルが接ベクトルではなくて変位ベクトル$z$である点が違うが，あと少しで微分形式のことだな．

\begin{remark}
    微分係数$\frac{dy}{dx}$の定義式は高校の時から使い慣れているものであるが，$dx, dy$の定義は難しくなる．第一義的には$dy:=\frac{dy}{dx}dx$と考えていれば良い．これは関数の微分(differential of a function)と言って，差分を極めた概念としての「微分」である，ある関数の導関数を求めるという意味での微分(differentiation)とは違う．後者は演算である．
    
    関数$f$が多変数であることを強調する時，特に$df$を全微分(total differential)という．
    また，これを完全微分(exact differential)というときは，興味のある微分$df$が，ある可微分関数$Q$の全微分$dQ$になっているという積分をしようとしている文脈において言う．このとき実数値関数$Q$をpotentialと言う．

    この概念の定式化の方法は何通りもある．以下はWikipediaが挙げている４つである．

    1(線型主要部). Differentials as linear maps. This approach underlies the definition of the derivative and the exterior derivative in differential geometry.[1]
    
    2(代数幾何学). Differentials as nilpotent elements of commutative rings. This approach is popular in algebraic geometry.[2]

    3(総合微分幾何学). Differentials in smooth models of set theory. This approach is known as synthetic differential geometry or smooth infinitesimal analysis and is closely related to the algebraic geometric approach, except that ideas from topos theory are used to hide the mechanisms by which nilpotent infinitesimals are introduced.[3]

    4(超準解析). Differentials as infinitesimals in hyperreal number systems, which are extensions of the real numbers that contain invertible infinitesimals and infinitely large numbers. This is the approach of nonstandard analysis pioneered by Abraham Robinson.[4]
\end{remark}

\begin{theorem}[多変数のTaylorの定理]
    $f:\mathbb{R}\to\mathbb{R},\; x,a\in\mathbb{R}$とする．次が成り立つ．
    \[ \exists c\in[x,a]  \]
\end{theorem}

\section{位相からの準備}
\begin{shadebox}\begin{definition}$D \subset \mathbb{R}$，$P \in D$とする．\\
1, $P$が$D$の内点である $\Longleftrightarrow$ $\exists r>0 \, \mathrm{s.t.} \, B(P,r):=\{ Q \in \mathbb{R}^2 | d(P,Q)<R \} \subset D$ \\
\noindent
＊ただし，$d$とは距離函数で，$d(P,Q)=\sqrt{(p_1-q_1)^2 + (p_2-q_2)^2}=|P-Q|$\\
2, $P$が$D$の外点である $\Longleftrightarrow$ $\exists r>0 \, \mathrm{s.t.} \, B(P,r) \cap D=\emptyset$ \\
$\Longleftrightarrow$ $P$が$D^c$の内点．\\
3, $P$が$D$の境界点である $\Longleftrightarrow$ $\exists r>0 \, \mathrm{s.t.} \, B(P,r) \cap D\neq \emptyset \land B(P,r) \cap D^c \neq \emptyset$ 
\end{definition}\end{shadebox}
\noindent
＊$D$の境界点が全て$D$に含まれる$\Longrightarrow$Dは閉集合．$D$の境界点が全て$D$に含まれない$\Longrightarrow$Dは開集合．（$D$が開集合$\Longleftrightarrow D^c$が閉集合．\\
＊微積分学の考察対象は大体全て「領域」で定義されている．

\begin{shadebox}\begin{definition}[連結・領域]$D$の任意の点$P,Q$に対して，$P,Q$を結ぶ$D$内の曲線が存在する時，$D$を（弧状）連結という．特に，$D$が開集合でもある時に，これを「領域」という．
\end{definition}\end{shadebox}

\begin{shadebox}\begin{definition}[点列]$\mathbb{R}^2$上の点列$\{Pn\}$が，$P\in \mathbb{R}^2$に収束する，とは，$$\lim_{n\to \infty} d(Pn,P)=0 \mathrm{（これを} \lim_{n\to \infty} Pn=P \mathrm{とも書く．} $$
\end{definition}\end{shadebox}
\noindent
＊点列の極限は，存在すればただ一つである．\\
＊収束する点列は有界である．\\
＊収束列の全ての部分列は，同じ極限点に収束する．
\begin{theorem}[Bolzano-Weierstrassの定理]($\mathbb{R}^2$上の)有界な点列は，収束する部分列を持つ．\end{theorem}
\begin{theorem}[Cauchy列は収束する]点列$\{ Pn \}$が収束列であることと，点列$\{ Pn \}$がCauchy列であることは，$\mathbb{R}^n$上では同値である．ただし，Cauchy列であるとは，点列が$$\forall \epsilon >0, \exists N \in \mathbb{N} \forall n,m \in \mathbb{N} d(Pn,Pm)<\epsilon $$を満たすこと． \end{theorem}
\noindent
＊(remark)$D$が開集合$\Longleftrightarrow D$から取り出した収束列の極限点は，必ず$D$に属する．

\begin{definition}[連続性]$D \subset \mathbb{R}^2$を集合，$f:D \Longrightarrow \mathbb{R}$を写像，$P_0 \in \mathbb{R}^2, l \in \mathbb{R}$に対して，$$ \lim_{P \to P_0} f(P)=l \\ \Longleftrightarrow \forall \epsilon >0, \exists \delta>0 \forall P\in D 0<d(P,P_0)<\delta \Longrightarrow |f(P)-l|<\epsilon$$特に，$P_0 \in D, l=f(P_0)$である時，$f$は点$P$で連続であるという．\end{definition}

\begin{theorem}[最大値・最小値定理]\label{extreme_value_theorem}$D$を有界閉集合，$f$を$D$上連続な関数とすると，$f$は$D$上有界であり，その最大値と最小値を$D$の上に取る．\end{theorem}

\begin{definition}[偏微分]$f$を点$(x_0,y_0)$の近傍で定義された関数とする．$$\frac{\partial}{\partial x}f(x_0,y_0):=\lim_{h\to 0} \frac{f(x_0+h,y_0)-f(x_0,y_0)}{h}$$同様にして，$\frac{\partial}{\partial y}f$ $\frac{\partial^2}{\partial x^2}f$ $\frac{\partial^2}{\partial x \partial y}f$を定義する．\end{definition}

\begin{theorem}[Schwarzの定理]点$(a,b)$の周りで，$f_x, f_y, f_{xy}$が存在し，$f_{xy}$が$(a,b)$にて連続ならば，$f_{yx}(a,b)$は存在し，$f_{xy}(a,b)=f_{yx}(a,b)$を満たす．\end{theorem}
\begin{proof}$\varphi(x,y):=f(x,y)-f(x,b)$と置く．十分小さい$h,k>0$に対して，\begin{eqnarray*} \varphi(a+h,b+k) - \varphi(a,b+k) \\ &=& \varphi_x (a+\theta h,b+k)h (0<\exists \theta <1) \\ &=& \left[ f_x(a+\theta h,b+k) - f_x(a+\theta h,b) \right]  h\\  &=& f_{xy}(a+\theta h, b+\theta' k)hk (0<\exists \theta' <1) \end{eqnarray*}
一方，$\varphi$の定義より，$$\lim_{k\to 0} \frac{\varphi(x,b+k)}{k} = \lim_{k \to 0} \frac{f(x,b+k)-f(x,b)}{k} = f_y(x,b) $$よって，$$f_y(a+h,b) - f_y(a,b) \\ = \lim_{k \to 0} \frac{\varphi(a+h,b+k)-\varphi(a,b+k)}{k} \\ = h\lim_{h\to 0} f_{xy}(a+\theta h, b+\theta'h) $$故に，\begin{eqnarray*} f_{yx}(a,b)= \lim_{h\to0} \lim_{k\to0} f_{xy} (a+\theta h, b+\theta'h) \\ = f_{xy}(a,b) \hspace{10mm} f_{xy}\mathrm{の点}(a,b)\mathrm{での連続性より} \end{eqnarray*}
\end{proof}

\begin{definition}[全微分可能性]$f$を点$(a,b)$の近傍で定義された関数とする．$f$が点$(a,b)$で全微分可能であるとは，$\exists A,B \in \mathbb{R} \mathrm{s.t.} f(a+h,b+k)-f(a,b)=Ah+Bk+o(\sqrt{h^2+k^2})  \left( (h,k)\to(0,0) \right)$と定義する．\end{definition}
\noindent
＊$f$が点$(a,b)$で全微分可能\\ $\Longrightarrow$ $f$は点$(a,b)$で偏微分可能\\ $\Longrightarrow$ $A=f_x(a,b), B=f_y(a,b)$

\begin{theorem}$f_x,f_y$が存在し，$f_x$または$f_y$が連続．この時，$f$は全微分可能である．
\end{theorem}
\noindent
＊特に，$f$が$C^1$級の関数ならば，十分に全微分可能である．

\begin{theorem}[Chain Rule]$z=f(x,y), x=x(u,v), y=y(u,v)$の時，$$\frac{\partial z}{\partial u} = \frac{\partial z}{\partial x} \frac{\partial x}{\partial u} + \frac{\partial z}{\partial y} \frac{\partial y}{\partial u} \\  \frac{\partial z}{\partial v} = \frac{\partial z}{\partial x} \frac{\partial x}{\partial v} + \frac{\partial z}{\partial y} \frac{\partial y}{\partial v}$$が成り立つ．\end{theorem}

\begin{theorem}[Taylorの定理]$f$:領域$D$上の$C^n$級関数$(n=1,2,......)$\\線分$\{ (a+ht,b+kt) | 0<t<1 \}$が$D$に含まれているとする．
ここで，$F(t):=f(a+th,b+tk)$と置くと，\begin{eqnarray*} f(a+h,b+k)&=&F(1) \\ &=&F(0)+F'(0)+\frac{F''(0)}{2!}+...+\frac{F^{(n-1)}(0)}{(n-1)!}+\frac{F^{(n)}(\theta)}{n!}\\&=&f(a,b)+\left( h\frac{\partial}{\partial x}+ k\frac{\partial}{\partial y} \right)f(a,b)+...+\frac{1}{(n-1)!} \left( h\frac{\partial}{\partial x}+ k\frac{\partial}{\partial y} \right)^{(n-1)} f(a,b) + \frac{1}{n!} \left( h\frac{\partial}{\partial x}+ k\frac{\partial}{\partial y} \right)^n f(a+\theta h,b\theta k)   \end{eqnarray*} \end{theorem}

\begin{theorem}[陰関数定理]$F=F(x,y)$:点$(a,b)$の近傍で定義された$C^1$級関数．点$(a,b)$において，$F(a,b)=0, F_y(a,b) \neq 0$とする．この時，$\exists I$:点$a$を含む閉区間$\exists \delta>0$s.t.$\forall x \in I$に対して$F(x,y)=0, |y-b|<\delta$を満たす．$y$は唯一つ，この$I$上の関数$y=f(x)$は$C^1$級関数であり，$$f'(x)=-\frac{F_x(x,f(x))}{F_y(x,f(x))}$$
\end{theorem}



\chapter{極値判定問題}

\begin{shadebox}\begin{question}周の長さが一定$(=2s)$の三角形のうちで，面積最大のものは正三角形であることを示せ．\end{question}\end{shadebox}
\begin{proof}三角形の三辺の長さを$x,y,z$とする．対応する三角形の面積を$S$とすると，Heronの公式より，$$S^2=s(s-x)(s-y)(s-z) (2s=x+y+z) \\ =s(s-x)(s-y)(x+y-s)$$である．$f(x,y)=(s-x)(s-y)(x+y-s)$と置く．$x,y$が動く範囲は$$D:=\{ (x,y)|s-x>0, s-y>0 x+y-s>0 \}$$であるが，$f$に最大値が存在するには，$D$が閉集合でなくてはならない（すでに有界ではある）．$D$の拡張$\overline{D}$，$$\overline{D} := \{ (x,y)|s-x \ge 0, s-y \ge 0, x+y-s \ge 0 \}$$上で$f$を考える．$\overline{D}$は有界閉集合で，$f$はその上で連続であるから，最大値最小値定理\ref{extreme_value_theorem}より，$f$は$\overline{D}$上で最大値を取る．$f$は$D$上正，$D$の境界点上で零なので，最大値を取る点は$\overline{D}$の内点，つまり$D$上で取る．その点を$(x,y)\in D$とすると，$$f_x(x,y)=-(s-y)(x+y-s)+(s-x)(s-y)=0\\f_y(x,y)=-(s-x)(x+y-s)+(s-x)(s-y)=0\\ \Longrightarrow x=y=z$$よって，面積の最大値を与える三角形は正三角形である．
\end{proof}

\part{積分}
\chapter{一変数の積分}
\section{定積分}

第一義的な積分の定義である「Riemann和の極限」にて定義した(\ref{subsection-Riemann})後に，Darbouxの方法で等価な議論ができることを確認する(\ref{subsection-Darboux})．


\subsection{定積分の定義(Riemann積分)}\label{subsection-Riemann}

以降，$f$:有界閉区間$I=[a,b]\;(-\infty <a<b< \infty)$上の有界関数　と記号を定める．この有界関数$f$の有界閉区間$I$に対して面積を対応させる関数$$\int_I \cdot dx : I \longmapsto \int_I f(x)dx \in \mathbb{R}$$を定義することを考える（定積分）．
これはまず，「Riemann和の極限」として定義できるということを説明する．つまり，ある極限値が収束する（実数内の有限確定値を持つ）場合に，「積分が定義できる」とする．$$\int_I f(x)dx:=\lim_{|\Lambda|\to 0}R[\Lambda;\{\xi_k\}]:=\lim_{|\Lambda|\to 0}\sum^n_{k=1}f(\xi_k)\Delta x_k$$

\begin{itembox}[l]{記号の定義}
    区間$I$を，分点$(x_1, x_2, \cdots, x_{n-1})$を用いて，$a=x_0<x_1<x_2<\cdots <x_{n-1}<x_n=b$のように小区間(subinterval)に分けた時，分点の取り方を$\Delta :=(x_1, x_2, \cdots, x_{n-1})$と書き，各小区間を$I_k:=[x_{k-1},x_k]\, (k=1,2,\cdots,n)$と書く．

    各小区間の幅は$\Delta x_k := x_k - x_{k-1}$と定め，$|\Delta |:=\max_{1\le k\le n}(\Delta x_k)$と書いて「分割$\Delta$の最大幅」と呼ぶ．

    各小区間$I_k (k=1,2,\cdots,n)$から勝手に代表点を１つ取った時，それを$\xi_k(\in I_k)$と呼ぶ．これを用いて，分割$\Delta$と代表点列$\{ \xi_k \}$に対応するRiemann和$R[\Delta ; \{ \xi_k \}]$を
    \begin{center}\begin{tikzcd}
        R:\mathbb{R}^{2n-1} \ar[r] \ar[d, phantom, "\rotatebox{90}{$\in$}"] & \mathbb{R} \ar[d, phantom, "\rotatebox{90}{$\in$}"] \\
        (\Delta, \{ \xi_k \}) \ar[r, mapsto] & \sum^n_{k=1}f(\xi_k)\Delta x_k \ar[r, phantom, "="] &  R[\Delta ; \{ \xi_k \}]\\
    \end{tikzcd}\end{center}
    と定める．
\end{itembox}

\begin{shadebox}
    \begin{definition}[Riemann積分可能性]\label{Riemann integrable}
        ある定数$J\in\mathbb{R}$が存在して，$|\Delta |\rightarrow 0$とした時に，$\Delta, \{\xi_k\}$のそれぞれの取り方に依らず，$R[\Delta ; \{\xi_k\}]\rightarrow J$と定値写像になる時，即ち，
        $$J=\lim_{|\Delta|\to 0}R[\Delta;\{ \xi_k \}]$$である時，\textbf{$f$は$I$上\textrm{Riemann}積分可能／可積分}といい，$$\int_If(x)dx=J$$と書く．
    \end{definition}
    \begin{definition}[特別な定積分]
        上記の定義に当てはまらない場合の積分については，以下のように約束する．\\
        \begin{eqnarray*}
            \int^a_af(x)dx&=&0\\
            \int^b_af(x)dx &=& -\int^a_bf(x)dx　\hspace{10mm}（定積分の向き）
        \end{eqnarray*}
    \end{definition}
\end{shadebox}

\subsection{Darboux積分と積分可能性の判定}\label{subsection-Darboux}

Riemann和$R[\Lambda;\{\xi_k\}]$の収束性を直接議論するより，或る特別な優級数と劣級数とを考えた方が議論が簡明になる場合が多い．そのための議論の道具を用意し，このDarboux流の議論がしっかりRiemannの方法と等価になることを確認する．

\begin{itembox}[l]{記号の定義}
    各区間$I_k(k=1,2,\cdots,n)$での，有界関数$f$の上限と下限は必ず存在するから，これらを$M_k,m_k$と置く．この時，分割$\Delta$に対して
    \[ S[\Delta ] := \sum_\Delta M_k \cdot \Delta x_k \hspace{5mm} s[\Delta ] := \sum_\Delta m_k \cdot \Delta x_k \]
    と定めると，上限と下限の性質から
    \[ s[\Delta] \le R[\Delta;\{\xi_k\}] \le S[\Delta] \]
    が成り立つ．（$S$をupper Darboux sum, $s$をlower Darboux sumと言ったりする．）

    分割$\Delta$の各小区間$I_k$に対して，振動量$\omega$という特徴量を
    \begin{eqnarray*}\omega_k &:=& \sup \{ f(x)-f(x') | x,x' \in I_k \}\\ &=& M_k - m_k\end{eqnarray*}
    で定める．
    この時，\begin{eqnarray*}
        S[\Delta]-s[\Delta] &=& \sum_\Delta (M_k-m_k)\Delta x_k \\
        &=& \sum_\Delta \omega_k \Delta x_k
    \end{eqnarray*}と書き換えられる．

    また，２つの分割$\Delta, \Delta'$について，\\
    1. $\Delta$の分点が全て$\Delta'$の分点にもなっている時，「$\Delta'$は$\Delta$の細分（化）である」という．\\
    2. $\Delta$と$\Delta'$の両方の分点を採用して出来る分割を$\Delta\cup\Delta'$と書く．
    （結びの演算と半順序関係を入れた）
\end{itembox}

\begin{shadebox}
\begin{lemma}[分割の「細分化」に関する単調性]
    $\Delta'$を$\Delta$の細分とする．$$s[\Delta]\le s[\Delta'] \le S[\Delta'] \le S[\Delta]$$が成り立つ．
\end{lemma}
\begin{corollary}
    $\Delta$を任意の有限の分割として
    $$s:=\sup_\Delta (s[\Delta]) = \lim_{|\Delta|\to 0}S[\Delta], S:=\inf_\Delta (S[\Delta]) = \lim_{|\Delta|\to 0}s[\Delta]$$
    と置く．この時，$s\le  S$である．

    なお，sのことを$\underline{\int^b_a}f(x)dx$と書き\rm{lower Darboux integral}と，$S$を$\overline{\int^b_a}f(x)dx$と書き\textrm{upper Darboux integral}とも呼ぶ．
\end{corollary}
\begin{proposition}[Darbouxの定理]\label{Darboux-1}
    $|\Delta|\rightarrow 0$とすると，$S[\Delta]\rightarrow S, s[\Delta]\rightarrow s$となる．（つまり，分割$\Delta$の細かくするその仕方，勿論代表点列$\{\xi_k\}$の取り方に依らない．）
\end{proposition}
\begin{corollary}[Darboux IntegralとRiemann Integralの一致]\label{Darboux-2}
    $f$が$I$上\rm{Riemann}可積分であるとは，$S=s$，即ち，$\sup_\Delta (s[\Delta])=\inf_\Delta (S[\Delta])$であることに等しい（これが成り立つことを\textrm{Darboux integrable}と呼び分けることもあるが，そのための条件は\textrm{Riemann integrable}（定義\ref{Riemann integrable}）であることと同値．）．
    
    また，$$\forall \epsilon >0 \hspace{3mm} \exists \Delta:分割 \hspace{3mm} \mathrm{s.t.} \hspace{3mm} \sum_\Delta \omega_k \Delta x_k (=S[\Delta]-s[\Delta]) < \epsilon$$とも等価である．
\end{corollary}
\end{shadebox}

\begin{screen}
    \begin{example}
        $I=[0,1]$とし，
        $f(x)=\begin{cases}
            1 & (x\in\mathbb{Q}\cap I)\\
            0 & (x\in I-\mathbb{Q})
        \end{cases}$とする．この時，任意の分割に対して，任意の小区間で$M_k=1, m_k=0$となり，$S[\Delta]=1, s[\Delta]=0$が成立してしまうから，$S\neq s$となり，\textrm{Riemann}積分可能ではない．
    \end{example}
    \begin{example}
        有界閉区間$I=[a,b]$上の有界単調関数$f$は可積分である．

        なぜなら，$f(a)$と$f(b)$はこの区間での$f$の最大値か最小値かのいずれかであるが，これが定数である限り
        \begin{eqnarray*}
            S[\Delta]-s[\Delta] &=& \sum_{\Delta}\omega_k \Delta x_k \\ &\le & \sum_\Delta \omega_k |\Delta | \\ &=& |\Delta |\sum_\Delta \omega_k \\
            &=& |\Delta||f(b)-f(a)| \overset{|\Delta|\to 0}{\longrightarrow} 0
        \end{eqnarray*}が成り立つからである．（あとは命題\ref{Darboux-1}, \ref{Darboux-2}による．）
    \end{example}
    \begin{example}
        有界閉区間$I$上の連続関数$f$は可積分である．

        なぜならば，まず最大値最小値定理\ref{extreme_value_theorem}より，$f$は有界閉区間$I$で最大値と最小値をとり，有界関数である．次に，関数$f$が連続であるとき，定義域$I$が有界閉区間ならば，$f$はその上で一様連続である．(\textrm{Heine-Cantor}の定理)．従って，勝手にとった$\varepsilon >0$に対して，$\delta >0$が存在して，任意の$x,x'\in I$について$|x-x'|<\delta\Longrightarrow |f(x)-f(x')|<\varepsilon$となる．よって，$|\Delta |<\delta$となる分割$\Delta$をとれば
        \begin{eqnarray*}
            \sum_\Delta\omega_k \Delta x_k &<& \varepsilon \sum_\Delta x_k \\
            &=& \varepsilon (b-a)
        \end{eqnarray*}
        より，先ほどと同様$\lim_{|\Delta|\to 0}(S[\Delta]-s[\Delta])=0$より，$f$は$I$上可積分．
    \end{example}
\end{screen}

\begin{proof}{（補題９）}$S[\Delta']\le S[\Delta]$のみを考える．$s[\Delta]\le s[\Delta']$も同様．

    $\Delta$の各小区間の中で，$\Delta'$による分点をその中に含まないものは，$M_k \cdot \Delta x_k$の値は等しくなる．含むものは，それが何個であろうと，$\Delta$の場合の和$M_k \cdot \Delta x_k$より小さくなる．
    $$M_k \cdot \Delta x_k \ge M_k' \cdot \Delta x_k' + M_k'' \cdot \Delta x_k'' + \cdots + M_k^{(n)} \cdot \Delta x_k^{(n)}  \hspace{10mm}  (但し\Delta x_k = \Delta x_k' + \Delta x_k'' + \cdots + \Delta x_k^{(n)})$$
\end{proof}

現在，分割を細かくして行った時に，$S[\Delta]$の値が収束するならばその収束先は$S=\inf_Delta(S[\Delta])$と表せる．証明したいことは，これが本当に収束することと，分点の増やし方に依らずに一意な実数に収束することの２点である．（併しそれにしても下記の証明はtricky．思いつくかよこんなの）
\begin{proof}{（Darbouxの定理）}$S[\Delta]\rightarrow S$のみを考える．$s[\Delta]\rightarrow s$も同様．

    今，任意の$\epsilon >0$に対して，或る分割$\Delta_\epsilon$が存在して，$S\le S[\Delta_\epsilon]<S+\epsilon$を満たす．（与えられた値$S+\epsilon$に対してそれより十分小さな値を実現するほどに，細かい分点の取り方は存在する．）この分割$\Delta_\epsilon$の分点の個数を$p$，最小幅を$\delta := \min_{1\le k\le n}\Delta x_k$と置いた時に$|\Delta| < \min \{ \delta,\frac{\epsilon}{2pM} \}$を満たす任意の分割$\Delta$に対して，
    $$(0\le) S[\Delta]-S<2\epsilon \hspace{10mm} (|\Delta|=\min_{1\le k\le n}\Delta x_k) \hspace{15mm}\cdots (*)$$が成り立つことを示す．
    これが示せたら，「分点の細かくするその仕方」に依らず，分割の幅の言葉のみを使った単調減少列を構成できたこととなり，「分割の細かく仕方に依らず，幅を十分小さくすれば，$S[\Delta]$は$S$に収束する」つまり，$$\lim_{|\Delta|\rightarrow0}S[\Delta]=S$$を示せたこととなる．

    まず$S[\Delta] - S[\Delta\cup\Delta_\epsilon] = \sum_\Delta M_k \Delta x_k - \sum_{\Delta\cup\Delta_\epsilon}M_l \Delta x_l (\ge 0)$を評価することで２段階で結論を得る．
    ある区間$I_k$に注目すると，分割$\Delta$の幅は分割$\Delta_\epsilon$の最小幅$\delta$より小さいから，分割$\Delta$の区間$I_k$の内部に含まれる分割$\Delta\cup\Delta_\epsilon$の分点は高々１つである．
    \begin{tikzpicture}
        \draw[step=1, gray] (-1.5, -0.2) grid (1.5,0.2);
        \draw (-1.0, 0.7) node {$x_{l-1}$};
        \draw (0, 0.7) node {$x_{l}$};
        \draw (1.0, 0.7) node {$x_{l+1}$};
        \draw (-1.0,-0.5) node {$x_{k-1}$};
        \draw (1.0,-0.5) node {$x_{k+1}$};
        \draw (-2.2, -0.5) node {(分割$\Delta$)};
        \draw (-2.5, 0.5) node {(分割$\Delta\cup\Delta_\epsilon$)};
        \draw[rounded corners=20pt, <->] (-1.0, 0.1) -- (0, 0.1);
        \draw (-0.5, 0.3) node {$\Delta x_{l1}$};
        \draw[rounded corners=20pt, <->] (0, 0.1) -- (1.0, 0.1);
        \draw (0.5, 0.3) node {$\Delta x_{l2}$};
    \end{tikzpicture}従って，分点が内部にある場合は，$$M_k\Delta x_k - (M_{l1}\Delta x_{l1} + M_{l2}\Delta x_{l2}) \le 2M|\Delta |$$が成り立つ．（分点がない場合は$=0$である．）
    このような場合は，$\Delta_\epsilon$の分点がどれも$\Delta$の分点と共通していない時に，最大$p$回現れるので，$$S[\Delta] - S[\Delta\cup\Delta_\epsilon] \le 2Mp|\Delta | < \epsilon$$
    これと$S[\Delta\cup\Delta_\epsilon]-S\le S[\Delta_\epsilon]-S<\epsilon$と併せて，$$S[\Delta]-S<2\epsilon$$を得る．以上より，任意の$\epsilon >0$に対して，十分$|\Delta |$が小さい分割$\Delta$が存在して$S[\Delta]-S<\epsilon$と出来る（以上の議論を少し修正するだけ）ことが分かったから，定理は証明された．
\end{proof}

\subsection{定積分の性質}

\begin{shadebox}
    \begin{proposition}[定積分の性質]
        $f,g$を$I$上可積分な関数とする．\\
        1. $a\le c\le d\le b$とすると，$f$は$[c,d]$上可積分．\\
        2. 区間に関する加法性が成り立つ(additive)．$a<c<b$に対して$$\int^b_af(x)dx = \int^c_af(x)dx + \int^b_cf(x)dx$$
        3. 関数空間としての線型性が成り立つ．$\alpha,\beta\in\mathbb{R}$に対して$\alpha f + \beta g$も$I$上可積分とすると，$$\int^b_a(\alpha f(x)+\beta g(x))dx = \alpha\int^b_a f(x)dx + \beta\int^b_a g(x)dx$$
        4. $$f(x)\le g(x) \hspace{3mm} (x\in I) \Longrightarrow \int^b_af(x)dx \le \int^b_a g(x)dx$$
        \hspace{1zw}特に$f,g$が$I$上連続な関数ならば，等号成立条件は$f\equiv g \; \mathrm{on} \; I$の時．
    \end{proposition}
\end{shadebox}

\section{不定積分}

\begin{shadebox}
    \begin{proposition}
        関数$f$が$I=[a,b]$上可積分である時，$$F(x):=\int^x_af(t)dt$$は$I$上の連続関数である．
    \end{proposition}
    \begin{proposition}
        関数$f$が$I=[a,b]$上可積分であり，$x_0\in I$で$f$が連続であるとする．この時，$F(x)=\int^x_af(t)dt$は点$x_0$にて微分可能であり，$F(x_0)'=f(x_0)$となる．
    \end{proposition}
    \begin{corollary}
        $f:I=[a,b]$上連続である時，$F(x)=\int^x_af(t)dt$は$I$上$C^1$-級関数である．
    \end{corollary}
    \begin{theorem}[微分積分学の基本定理]
        $f:I=[a,b]$上可積分とする．関数$G=G(x)$が$f$の$I$に於ける原始関数の１つであるならば，$$\int^b_af(t)dt=G(b)-G(a)$$
    \end{theorem}
\end{shadebox}

\section{広義積分}
$f$を有界関数，$I$を有界閉区間として積分とは何かを，「Riemann和$R[\Lambda;\{\xi_k\}]$の$|\Lambda|\to 0$極限として厳密に定義して来た．
その土台の上に，より多くの関数と積分区間に拡張出来ないか模索していく．広義積分可能であるとは，これもまた何らかの極限が収束することに等しい．
この時，すでに$I$上で定義された積分$\int^b_af(x)dx=I(a)$から，$a$（又は$b$）を何らかの近隣の値$a'$に近づけた（又は無限大に発散させた）時の$\lim_{a\to a'}I(a)=:\int^b_{a'}f(x)dx$の値が収束するかによって，広義積分可能かを定義することとなる．
従って，級数の収束性の議論と全くパラレルなものとなる．

\subsection{非有界な関数の積分}

\begin{itembox}[l]{有限個の特異点を持った関数の積分}
    \begin{definition}
        $(a,b]$上で定義された関数fの，有界閉区間$I=[a,b]$での積分値を定めたい．今（有界とは限らない）関数$f$は$a<a'<b$を満たす全ての$a'$について$[a',b]$上可積分とする．
        この時，$$\lim_{a'\to a+0}\int^b_{a'}f(t)dt$$が存在するならば，$f$は\textbf{$(a,b]$上広義Riemann積分可能}だといい，その極限値を$$\lim_{a'\to a+0}\int^b_{a'}f(t)dt = \int^b_af(t)dt$$と書く．
    \end{definition}
\end{itembox}

この定義を必要ならば再帰的に繰り返し用いることにより，有限個の特異点（値が発散する点）を持った関数までなら，Riemann積分の値を定義できる．

ただし，ここで言う特異点とは，その点に於ける近傍では関数$f$が有界でなくなるような点のことを言う．即ち，$\overline{\lim_{x\to a}}|f(x)|=\infty$を満たす$a$のことである．

\subsection{無限区間での積分}

\begin{itembox}[l]{非有界区間での積分}
    \begin{definition}
        $f:[a,\infty)$上の関数とする．任意の$a'\in (a,\infty)$について$f$が$[a,a']$上（広義でも狭義でも）積分可能であるとき，極限値$$\lim_{a'\to\infty}\int^{a'}_af(t)dt$$が存在するならば，$f$は\textbf{$[a,\infty)$上広義Riemann積分可能}であるといい，
        $$\lim_{a'\to\infty}\int^{a'}_af(t)dt = \int^\infty_af(t)dt$$と書く．
    \end{definition}
\end{itembox}

\begin{screen}
    \begin{example}[調和級数が発散することとのつながりを感じる例]次の定積分を求めよ．
        $$\int^1_0\frac{dx}{x^\lambda}\hspace{3mm}(\lambda\in\mathbb{R})$$

        \rm (1)\;$\lambda <1$の時．特に$0<\lambda <1$の場合は関数$\frac{1}{x^\lambda}$は$x=0$にて定義されて居ないことに注意する．$0<\varepsilon <1$について，
        $$\int^1_\varepsilon \frac{dx}{x^\lambda} = \frac{1-\varepsilon^{1-\lambda}}{1-\lambda}$$より，$\varepsilon\to 0$の極限を考えて，
        $$\int^1_0 \frac{dx}{x^\lambda} = \frac{1}{1-\lambda} \hspace{5mm} (\lambda <1)$$を得る．

        (2)\;$\lambda = 1$の時，$0<\varepsilon <1$に対して
        $$\int^1_\varepsilon \frac{dx}{x^\lambda}=-\log\varepsilon \longrightarrow +\infty \hspace{3mm} (\varepsilon\to 0)$$
        であるから，積分値は定義されない．

        (3)\;$\lambda>1$の時，積分値は(1)の場合と同様の計算で定まり，
        $$\int^1_0 \frac{dx}{x^\lambda} = \frac{1}{1-\lambda} \hspace{5mm} (\lambda \neq 1)$$
        と分かる．
    \end{example}
\end{screen}

\subsection{主値積分}

$\int^1_0\frac{dx}{x}$が定義されないことは前節で見たが，一方で$\int^1_{-1}\frac{dx}{x}$は以下の方法で値を考えることも可能である．
\[ \left( \int^{-\varepsilon}_{-1} + \int^1_\varepsilon \right) \frac{dx}{x}=0 \]

ただし，Riemannの方法ではこの積分は存在しない．
\begin{eqnarray*}
    \int^1_{-1}\frac{dx}{x} &=& \lim_{\varepsilon\to 0, \varepsilon'\to 0} \left( \log\varepsilon - \log\varepsilon' \right) \\
    &=& \lim_{\varepsilon\to 0, \varepsilon'\to 0} \log\frac{\varepsilon}{\varepsilon'}
\end{eqnarray*}
この極限は存在しない．近づけ方によって値が変わってしまい，先述した0という値もそのうちの１つに過ぎない．

このように，
$$\lim_{u\rightarrow b-0}\int_a^u f(x)\,dx=\pm\infty$$
$$\lim_{v\rightarrow b+0}\int_v^c f(x)\,dx=\mp\infty$$
に対して，
$$\lim_{\varepsilon\rightarrow 0+} \left(\int_a^{b-\varepsilon} f(x)\,dx + \int_{b+\varepsilon}^c f(x)\,dx \right)$$
で定義された値をCauchyの主値(principle value)と呼び，$$\mathcal{P}\int f(x)dx, \; PV\int f(x)dx$$などと表す．

\subsection{Riemann積分可能でRebesgue積分可能でない関数}

$$\int^\infty_0 \frac{\sin x}{x}dx = \frac{\pi}{2}$$など．
積分には定義の仕方が幾通りも存在するが，全てを統合するような視点は（まだ）存在しない．

\subsection{広義積分の収束}
積分区間が半開区間$[a,\infty)$である場合の広義積分に話を限る．
$$\int^\infty_a f(x)dxが定義できる\hspace{5mm} \Longleftrightarrow \hspace{5mm} 関数F(x):=\int^x_af(t)dtがx\to\infty の極限で収束する$$
であるから，広義積分が定義出来るかの議論は，（実数列としての）収束性の議論に帰着する．

\begin{itembox}[l]{絶対可積分}
    以降，関数$f$の定義域$[a,b]$内の点$c$であって，任意の$\delta >0$に対して$|c-x|<\varepsilon\hspace{3mm}\Longrightarrow\hspace{3mm} f(x)>\delta$を満たす$\varepsilon >0$が存在する時に，この点$c$を\textbf{特異点}ということとする．

    \begin{definition}[絶対可積分]
        $A\subset\mathbb{R}$にて，広義積分$\int_Af(x)dx$が定義されているとする．この時更に，$\int_A|f(x)|dx$も可積分となる時，「広義積分$\int_Af(x)dx$は絶対収束する」といい，この時「\textbf{fは絶対可積分である}」という．
    \end{definition}
    \begin{proposition}[広義積分と通常の定積分との違い] \label{prop integrale generalisee}　\\
    1. 広義積分$\int^b_af(x)dx$が収束しても，$\int^b_a|f(x)|dx$が収束するとは限らない．しかし，もしするならば，やはり三角不等式$$\left|\int^b_af(x)dx\right|\le\int^b_a|f(x)|dx$$が成り立つ．\\
    2. $$fが可積分\hspace{5mm} \Longleftarrow \hspace{5mm}fが絶対可積分$$
    （例\ref{sin/x}参照）
    \end{proposition}
\end{itembox}

\begin{shadebox}これは灯台のような定理であって，実際に使うようなものではない．実際の示し方やなぜこの定理が成り立つかについての知恵は，次の例を通して得るのが良い．
    \begin{theorem}[広義積分の絶対収束するかの判定方法]　\\
        (1)\hspace{5mm} 区間$(a,b]$に於て関数$f(x)$は積分可能で，$a$が$f$の特異点だとする．この時，或る$0<\alpha <1$なる指数$\alpha$が存在して，$(x-a)^\alpha |f(x)|$については$x=a$は特異点ではなくなるならば，$\int^b_af(x)dx$は絶対収束する．\\
        (2)\hspace{5mm} 区間$[a,\infty)$において関数$f(x)$は積分可能であるとする．この時，或る$1<\alpha$なる指数$\alpha$が存在して，$x^\alpha |f(x)|$が区間$[a,\infty)$において有界となるならば，積分$\int^\infty_af(x)dx$は絶対収束する．
    \end{theorem}
\end{shadebox}

\begin{screen}
    \begin{example}\label{example-power}Taylor展開を利用して，多項式による優積分と劣積分を見つけて，以下の例に帰着する手法が王道となる．
        $$\int^\infty_1x^\alpha dx=\begin{cases}
            -\frac{1}{\alpha +1} & \alpha <-1 \\
            +\infty & \alpha \ge -1
        \end{cases}$$
        $$\int^1_0 x^\beta dx=\begin{cases}
            \frac{1}{\beta +1} & \beta >-1 \\
            +\infty & \alpha \le -1
        \end{cases}$$
    \end{example}
    \begin{example}\label{example gamma function}
        $$\int^\infty_0 e^{ax}x^\beta dx$$は，$a<0, \beta>-1$の時のみ収束し，この時絶対収束である．従って，
        $$\Gamma (x) = \int^\infty_0 t^{x-1} e^{-t}dt (x>0)$$と置くと，この値は定義域内で常に定まる．
    \end{example}
    \begin{example}\label{sin/x}
        $$\int^\infty_0\frac{\sin x}{x}dxは収束するが，\int^\infty_0\frac{|\sin x|}{x}dxは収束しない．$$
    \end{example}
\end{screen}

広義積分が定義できるかの判定方法は，数列の収束性の議論と平行で，絶対収束の判定条件は大別して以下の３通りがある．
なお，$f(x)\ge 0 \hspace{3mm}\forall x\in [0,\infty )$と仮定した時，$I(R)=\int^R_0f(x)dx$は単調増加となることに注意．

(1)Cauchy列：$\int^q_pf(x)dx$の，$p<q, p,q\to\infty$とした時の収束性を見る．\\
\begin{eqnarray*}
    & & \int^\infty_af(x)dx=\lim_{x\to\infty}\int^x_af(t)dtが収束する．F(x)=\int^x_af(t)dtと置く．\\
    &\Longleftrightarrow& \forall \varepsilon >0 \hspace{3mm} \exists p,q \hspace{3mm} p<q \Longrightarrow |F(q)-F(p)|<\varepsilon \\
    &\Longleftrightarrow& \lim_{p,q\to\infty, p<q}\left| \int^q_p f(x)dx \right| = 0
\end{eqnarray*}
これより，$\int^\infty_a|f(x)|dx$が収束すると仮定すると，$$\left|\int^\infty_af(x)dx\right| \le \int^\infty_a|f(x)|dx$$から$\int^\infty_af(x)dx$も収束することが分かるから，命題\ref{prop integrale generalisee}の1が確認できる．

(2)有界な単調列は収束する\\
$f(x)\ge 0\hspace{3mm}(\forall x\in [a,\infty))$とする．
\[\int^\infty_af(x)dxが可積分である\hspace{5mm}\Longleftrightarrow\hspace{5mm}\int^x_af(x)dxは全てのx\in [a,\infty )に於て有界\]

(3)優級数判定法\\
或る非負値関数$\varphi$について，$|f(x)|\le\varphi (x) \hspace{3mm} (x\in[a,\infty))$とする．
$$\int^\infty_a\varphi (x)dxが収束する\hspace{5mm}\Longrightarrow\hspace{5mm}\int^\infty_af(x)dxは絶対収束する$$

\begin{proof}{例\ref{example gamma function}の導出}
    $$\int^\infty_0 e^{ax}x^\beta dx = \int^1_0 e^{ax}x^\beta dx + \int^\infty_1 e^{ax}x^\beta dx$$と分解し，第一項を$I_1$，第二項を$I_2$として考える．$\int^\infty_0 e^{ax}x^\beta dx$が収束するのは，$I_1, I_2$の両方が収束する場合である．

    区間$[0,1]$において，$I_1$の値を考える．$
    \begin{cases}
        1\le e^{ax}\le e^a & a\ge 0\\
        e^a\le e^{ax}\le 1 & a\le 0
    \end{cases}$であるから，
    \begin{eqnarray*}
        \int^1_0x^\beta dx \le \int^1_0 e^{ax}x^\beta dx \le e^{a}\int^1_0 x^\beta dx &\hspace{5mm}& (a\ge 0)\\
        e^{a}\int^1_0 x^\beta dx \le \int^1_0 e^{ax}x^\beta dx \le \int^1_0 x^\beta dx &\hspace{5mm}& (a\le 0)
    \end{eqnarray*}を得る．従って，$\alpha$の正負に依らず，$\beta >-1$の時収束．

    区間$[1,\infty)$において，$I_2$の値を考える．任意の$n$についてTaylorの定理から，$$e^{ax}\ge\frac{(ax)^n}{n!}$$を導ける．

    $a>0$の時，任意の$n\in\mathbb{N}$について
    $$\frac{a^n}{n!} \int^\infty_1 x^{\beta+n} dx \le  \int^\infty_1 e^{ax}x^\beta dx$$を得る．$\beta\in\mathbb{R}$に対して十分大きな$n\in\mathbb{N}$を取って$\beta + n\ge -1$となる場合を考えることで，$a>0$の時$I_2$は常に発散することがわかる．

    $a=0$の時，$$I_2= \int^\infty_1 x^\beta dx$$より，$\beta < -1$の時収束する．

    $a<0$の時，$$\frac{1}{e^{|a|x}}\le\frac{1}{\frac{(|a|x)^n}{n!}}\hspace{5mm}(\forall n\in\mathbb{N})$$を用いて
    $$ \int^\infty_1 e^{ax}x^\beta dx \le \frac{n!}{|a|^n}\int^\infty_1 x^{\beta -n} dx\hspace{5mm}(\forall n\in\mathbb{N})$$
    を得るから，同様に$\beta -n <-1$となる場合を考えることによって，$I_2$は常に収束することがわかる．（列$\{\int^R_1 e^{ax}x^\beta dx\}_{R\in\mathbb{R}}$は上に有界で，単調増加であるため．）

    以上より，$I_1,I_2$の両方が収束するのは$a<0,\beta >-1$の収束性を直接議論するより，或る特別な優級数と劣級数とを考えた方が議論が簡明になる場合が多い．そのための議論の道具を用意し，このDarboux流の議論がしっかりRiemannの方法と等価になることを確認する．

    これより，関数$$I(a,b)=\int^\infty_0 e^{-|a|x}x^bdx\hspace{5mm}(a\in\mathbb{R}, b>-1)$$という実数値関数を定めることができる．
    これを$a=1$として少し整理したものを\textbf{ガンマ関数}という．
    $$\int^\infty_0 e^{-x}x^{\beta -1}dx=:\Gamma (b) \hspace{5mm}(\beta >0)$$
    これは階乗の概念を一般化したものと捉えられ，定義域は一般の複素数にまで拡張できる．
    
    \begin{eqnarray*}
        \Gamma (1) &=& \int^\infty_0 \frac{dt}{e^t}\\
        &=&  \left. \lim_{R\to\infty}-\frac{1}{e^t}\right|^R_0\\
        &=&  \lim_{R\to\infty}\left(1-\frac{1}{e^R}\right)\\
        &=& 1\\
        \Gamma (n+1) &=& \int^\infty_0\frac{t^n}{e^t}dt \\
        &=& \left. n\frac{t^{n-1}}{e^t}\right|^\infty_0 + n\int^\infty_0\frac{t^{n-1}}{e^t}dt\\
        &=& n\Gamma (n)
    \end{eqnarray*}
\end{proof}

\subsection{ガンマ関数とベータ関数}
少し脇道にそれて，良い練習問題として，ガンマ関数とベータ関数の基本性質と関係式を確認する．

ガンマ関数は階乗の概念を複素数平面上にまで拡張する関数であるが，特に半整数の場合を見てみると，$\sqrt{\pi}$の有理数倍になる．これは$\Gamma (\frac{1}{2})$がガウス積分に等しいからである．
\begin{eqnarray*}
    \Gamma (\frac{1}{2}) &=& \int^\infty_0e^{-t}t^{-\frac{1}{2}}dt \\
    ここでt=x^2と変数変換をすると，dt=2xdxより，\\
    &=& \int^\infty_0 e^{-x^2}x^{-1}2xdx \\
    &=& 2\int^\infty_0 \exp(-x^2)dx\\
    &=& \int^\infty_{-\infty} \exp(-x^2)dx = \sqrt{\pi}
\end{eqnarray*}

\section{定積分の応用}

\section{原始関数の求め方}

\subsection{有理関数の積分}


\begin{shadebox}
    \begin{theorem}[部分分数展開]
        
    \end{theorem}
\end{shadebox}

\chapter{重積分}

\section{重積分}

\section{重積分の計算１：累次積分}

\section{広義重積分}

\section{重積分の計算２：変数変換}

\section{重積分の応用}

\chapter{級数}

\section{正項級数の収束判定}

\section{条件収束と絶対収束}

\section{関数列と関数項級数}

\section{整級数}

\end{document}